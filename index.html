<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soul Age Calculator - Complete Vedantic & Jaimini Analysis</title>
    
    <!-- Security Headers via Meta Tags -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://maps.googleapis.com https://maps.gstatic.com; script-src 'self' 'unsafe-inline' https://maps.googleapis.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; img-src 'self' data: https://maps.googleapis.com https://maps.gstatic.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self' https://maps.googleapis.com; frame-ancestors 'none';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="no-referrer">
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">
    
    <!-- SEO & Privacy Compliant Meta Tags -->
    <meta name="description" content="Discover your soul's evolutionary journey through 777 incarnations using Vedantic wisdom, Theosophical teachings, and Jaimini astrology. Complete karaka analysis included.">
    <meta name="keywords" content="soul age, 777 incarnations, Vedanta, Theosophy, spiritual evolution, Jaimini astrology, karma, reincarnation, atmakaraka, karakas">
    <meta name="author" content="Soul Age Calculator">
    <meta name="robots" content="index, follow">
    
    <!-- Privacy & Security -->
    <meta name="privacy" content="No user data collected or stored">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Soul Age Calculator - Complete Jaimini & Vedantic Analysis">
    <meta property="og:description" content="Calculate your position in the 777-incarnation journey with complete Jaimini Karaka analysis.">
    
    <style>
        :root {
            --primary: #8B5CF6;
            --secondary: #06B6D4;
            --accent: #F59E0B;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --text: #1F2937;
            --bg: #F9FAFB;
            --white: #FFFFFF;
            --border: #E5E7EB;
            --gradient1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient2: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: var(--gradient1);
            min-height: 100vh;
            padding: 20px;
            color: var(--text);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--white);
            border-radius: 20px;
            box-shadow: var(--shadow-xl);
            overflow: hidden;
        }

        .header {
            background: var(--gradient2);
            color: white;
            padding: 50px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: 'üïâÔ∏è';
            position: absolute;
            font-size: 200px;
            opacity: 0.1;
            top: -50px;
            right: -50px;
            transform: rotate(-15deg);
        }

        .title {
            font-size: 3rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }

        .tabs {
            display: flex;
            background: var(--bg);
            border-bottom: 2px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            min-width: 120px;
            padding: 20px 15px;
            text-align: center;
            cursor: pointer;
            background: transparent;
            border: none;
            color: var(--text);
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            white-space: nowrap;
        }

        .tab:hover {
            background: rgba(139, 92, 246, 0.05);
        }

        .tab.active {
            color: var(--primary);
            background: rgba(139, 92, 246, 0.08);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: scaleX(0);
            }
            to {
                transform: scaleX(1);
            }
        }

        .content {
            padding: 40px;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            background: var(--bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .section:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border);
        }

        .section-icon {
            font-size: 2rem;
            margin-right: 15px;
        }

        .section-title {
            font-size: 1.6rem;
            color: var(--primary);
        }

        .input-group {
            margin-bottom: 25px;
            position: relative;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text);
            font-size: 0.95rem;
        }

        .input-field {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--white);
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .date-input-grid {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 15px;
            align-items: end;
        }

        .time-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .validation-icon {
            position: absolute;
            right: 15px;
            top: 42px;
            font-size: 1.2rem;
            display: none;
        }

        .validation-icon.valid {
            color: var(--success);
            display: block;
        }

        .validation-icon.invalid {
            color: var(--error);
            display: block;
        }

        .error-message {
            color: var(--error);
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .location-input-container {
            position: relative;
        }

        .pac-container {
            background-color: var(--white);
            border: 2px solid var(--border);
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-top: 5px;
            font-family: 'Georgia', serif;
        }

        .pac-item {
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .pac-item:hover {
            background: var(--bg);
        }

        .pac-item:last-child {
            border-bottom: none;
        }

        .pac-matched {
            font-weight: bold;
            color: var(--primary);
        }

        .unknown-time-btn {
            width: 100%;
            padding: 10px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .unknown-time-btn:hover {
            background: #0891B2;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .calculate-btn {
            width: 100%;
            padding: 20px;
            background: var(--gradient2);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }

        .calculate-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .calculate-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(139, 92, 246, 0.3);
        }

        .results-container {
            display: none;
            margin-top: 40px;
        }

        .results-container.show {
            display: block;
            animation: slideUp 0.5s ease;
        }

        .result-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.05) 0%, rgba(6, 182, 212, 0.05) 100%);
            border: 2px solid var(--primary);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 1.4rem;
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .result-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent);
            margin: 10px 0;
        }

        .karaka-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .karaka-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .karaka-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .karaka-planet {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .karaka-name {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .karaka-meaning {
            font-size: 0.9rem;
            color: var(--text);
            opacity: 0.8;
        }

        .stage-indicator {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            padding: 20px;
            background: var(--bg);
            border-radius: 10px;
        }

        .stage-item {
            text-align: center;
            flex: 1;
            padding: 10px;
            position: relative;
        }

        .stage-item.active {
            background: var(--gradient2);
            color: white;
            border-radius: 10px;
        }

        .stage-number {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stage-label {
            font-size: 0.9rem;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: var(--border);
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient2);
            border-radius: 15px;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: bold;
        }

        .wisdom-quote {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%);
            border-left: 4px solid var(--primary);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            font-style: italic;
        }

        .accordion {
            margin-top: 20px;
        }

        .accordion-item {
            border: 1px solid var(--border);
            border-radius: 10px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .accordion-header {
            padding: 15px 20px;
            background: var(--bg);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
        }

        .accordion-header:hover {
            background: rgba(139, 92, 246, 0.05);
        }

        .accordion-header.active {
            background: var(--gradient2);
            color: white;
        }

        .accordion-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

        .accordion-content.show {
            padding: 20px;
            max-height: 1000px;
        }

        .chart-container {
            width: 100%;
            height: 400px;
            margin: 20px 0;
            position: relative;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }

        .tooltip-icon {
            color: var(--primary);
            font-size: 0.9rem;
        }

        .tooltip-text {
            visibility: hidden;
            width: 250px;
            background-color: var(--text);
            color: var(--white);
            text-align: left;
            border-radius: 8px;
            padding: 10px;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .date-input-grid,
            .time-grid {
                grid-template-columns: 1fr;
            }

            .tabs {
                overflow-x: auto;
            }

            .tab {
                font-size: 0.85rem;
                padding: 15px 10px;
            }

            .karaka-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">üïâÔ∏è Soul Age Calculator</h1>
            <p class="subtitle">Complete Vedantic Journey & Jaimini Karaka Analysis</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('calculator')">
                <span>üìä Calculator</span>
            </button>
            <button class="tab" onclick="switchTab('jaimini')">
                <span>üîÆ Jaimini Analysis</span>
            </button>
            <button class="tab" onclick="switchTab('detailed')">
                <span>üìà Detailed Results</span>
            </button>
            <button class="tab" onclick="switchTab('wisdom')">
                <span>üìö Ancient Wisdom</span>
            </button>
            <button class="tab" onclick="switchTab('stages')">
                <span>üé≠ Soul Stages</span>
            </button>
            <button class="tab" onclick="switchTab('vedantic')">
                <span>üïâÔ∏è Vedantic Path</span>
            </button>
            <button class="tab" onclick="switchTab('guidance')">
                <span>‚ú® Guidance</span>
            </button>
            <button class="tab" onclick="switchTab('faq')">
                <span>‚ùì FAQ</span>
            </button>
        </div>

        <div class="content">
            <!-- Tab 1: Calculator -->
            <div id="calculator-tab" class="tab-content active">
                <!-- Birth Information -->
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">üìÖ</span>
                        <h2 class="section-title">Birth Information</h2>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Birth Date *</label>
                        <div class="date-input-grid">
                            <div>
                                <label style="font-size: 0.9rem; color: #6B7280;">Day</label>
                                <input type="number" 
                                       id="birthDay" 
                                       class="input-field" 
                                       placeholder="DD" 
                                       min="1" 
                                       max="31"
                                       onchange="validateDate()"
                                       oninput="validateDate()"
                                       required>
                            </div>
                            <div>
                                <label style="font-size: 0.9rem; color: #6B7280;">Month</label>
                                <select id="birthMonth" class="input-field" onchange="validateDate()" required>
                                    <option value="">Select Month</option>
                                    <option value="1">January</option>
                                    <option value="2">February</option>
                                    <option value="3">March</option>
                                    <option value="4">April</option>
                                    <option value="5">May</option>
                                    <option value="6">June</option>
                                    <option value="7">July</option>
                                    <option value="8">August</option>
                                    <option value="9">September</option>
                                    <option value="10">October</option>
                                    <option value="11">November</option>
                                    <option value="12">December</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size: 0.9rem; color: #6B7280;">Year</label>
                                <input type="number" 
                                       id="birthYear" 
                                       class="input-field" 
                                       placeholder="YYYY" 
                                       min="1874"
                                       max="2025"
                                       onchange="validateDate()"
                                       oninput="validateDate()"
                                       required>
                            </div>
                        </div>
                        <span id="dateValidation" class="validation-icon">‚úì</span>
                        <div id="dateError" class="error-message"></div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">
                            Birth Time (Optional - defaults to noon if not provided)
                            <span class="tooltip">
                                <span class="tooltip-icon">‚ÑπÔ∏è</span>
                                <span class="tooltip-text">Accurate birth time enables precise Jaimini Karaka calculations and soul age determination</span>
                            </span>
                        </label>
                        <div class="time-grid">
                            <div>
                                <label style="font-size: 0.9rem; color: #6B7280;">Hour</label>
                                <select id="birthHour" class="input-field" onchange="validateTime()">
                                    <option value="">Hour</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size: 0.9rem; color: #6B7280;">Minute</label>
                                <input type="number" id="birthMinute" class="input-field" 
                                       placeholder="MM" 
                                       min="0" 
                                       max="59" 
                                       onchange="validateTime()"
                                       oninput="validateTime()">
                            </div>
                            <div>
                                <label style="font-size: 0.9rem; color: #6B7280;">AM/PM</label>
                                <select id="ampm" class="input-field" onchange="validateTime()">
                                    <option value="">Select</option>
                                    <option value="AM">AM</option>
                                    <option value="PM">PM</option>
                                </select>
                            </div>
                        </div>
                        <button type="button" class="unknown-time-btn" onclick="useUnknownTime()">
                            Don't Know Time - Use Noon
                        </button>
                        <span id="timeValidation" class="validation-icon">‚úì</span>
                        <div id="timeError" class="error-message"></div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">
                            Birth Location *
                            <span class="tooltip">
                                <span class="tooltip-icon">‚ÑπÔ∏è</span>
                                <span class="tooltip-text">Location is essential for calculating planetary positions and karmic influences</span>
                            </span>
                        </label>
                        <div class="location-input-container">
                            <input type="text" 
                                   id="birthLocation" 
                                   class="input-field" 
                                   placeholder="e.g., New York, London, Mumbai..."
                                   autocomplete="off"
                                   required>
                        </div>
                        <span id="locationValidation" class="validation-icon">‚úì</span>
                        <div id="locationError" class="error-message"></div>
                    </div>
                </div>

                <button class="calculate-btn" onclick="calculateSoulAge()">
                    Calculate Complete Soul Analysis üîÆ
                </button>

                <div id="results" class="results-container"></div>
            </div>

            <!-- Tab 2: Jaimini Analysis -->
            <div id="jaimini-tab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">üîÆ</span>
                        <h2 class="section-title">Jaimini Karaka System</h2>
                    </div>
                    <div id="jaiminiContent">
                        <p style="margin-bottom: 20px;">The Jaimini system uses Karakas (significators) to understand the soul's journey and purpose. Calculate your birth information first to see your personal Karaka analysis.</p>
                        
                        <div class="wisdom-quote">
                            "The Atmakaraka is the King of the horoscope, representing the soul's deepest desires and the lessons it must learn in this incarnation." - Maharishi Jaimini
                        </div>

                        <div class="accordion">
                            <div class="accordion-item">
                                <div class="accordion-header" onclick="toggleAccordion(this)">
                                    <span>Understanding the Seven Karakas</span>
                                    <span>‚ñº</span>
                                </div>
                                <div class="accordion-content">
                                    <h4>The Seven Chara Karakas:</h4>
                                    <ul style="list-style: none; padding: 0;">
                                        <li style="margin: 10px 0;"><strong>1. Atmakaraka (AK)</strong> - The Soul Significator: Represents the soul's desire and primary lesson</li>
                                        <li style="margin: 10px 0;"><strong>2. Amatyakaraka (AmK)</strong> - The Mind/Career Significator: Shows career path and mental inclinations</li>
                                        <li style="margin: 10px 0;"><strong>3. Bhratrikaraka (BK)</strong> - The Sibling Significator: Represents siblings, courage, and initiatives</li>
                                        <li style="margin: 10px 0;"><strong>4. Matrikaraka (MK)</strong> - The Mother Significator: Shows mother, nurturing, and education</li>
                                        <li style="margin: 10px 0;"><strong>5. Pitrikaraka (PiK)</strong> - The Father Significator: Represents father, authority, and guidance</li>
                                        <li style="margin: 10px 0;"><strong>6. Putrakaraka (PuK)</strong> - The Children Significator: Shows children, creativity, and intelligence</li>
                                        <li style="margin: 10px 0;"><strong>7. Gnatikaraka (GK)</strong> - The Relatives/Obstacles Significator: Represents challenges and competitors</li>
                                        <li style="margin: 10px 0;"><strong>8. Darakaraka (DK)</strong> - The Spouse Significator: Shows spouse and partnerships</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 3: Detailed Results -->
            <div id="detailed-tab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">üìà</span>
                        <h2 class="section-title">Comprehensive Soul Analysis</h2>
                    </div>
                    <div id="detailedContent">
                        <p>Your detailed soul analysis will appear here after calculation. This includes:</p>
                        <ul style="list-style: none; padding: 20px 0;">
                            <li style="margin: 10px 0;">‚ú® Complete 777 incarnation position</li>
                            <li style="margin: 10px 0;">üéØ Current soul stage and level</li>
                            <li style="margin: 10px 0;">üìä Karmic debt analysis</li>
                            <li style="margin: 10px 0;">üîÆ Future incarnation predictions</li>
                            <li style="margin: 10px 0;">üí´ Soul purpose revelation</li>
                            <li style="margin: 10px 0;">üåü Spiritual gifts and challenges</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Tab 4: Ancient Wisdom -->
            <div id="wisdom-tab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">üìñ</span>
                        <h2 class="section-title">The 777 Incarnation Journey</h2>
                    </div>
                    
                    <div class="wisdom-quote">
                        "The soul, in its journey towards perfection, passes through 777 incarnations, each one a step in the grand staircase of consciousness." - Ancient Vedantic Text
                    </div>

                    <h3 style="color: var(--primary); margin: 20px 0;">The Seven Stages of Soul Evolution</h3>
                    
                    <div class="stage-indicator">
                        <div class="stage-item">
                            <div class="stage-number">1</div>
                            <div class="stage-label">Mineral</div>
                        </div>
                        <div class="stage-item">
                            <div class="stage-number">2</div>
                            <div class="stage-label">Plant</div>
                        </div>
                        <div class="stage-item">
                            <div class="stage-number">3</div>
                            <div class="stage-label">Animal</div>
                        </div>
                        <div class="stage-item">
                            <div class="stage-number">4</div>
                            <div class="stage-label">Human</div>
                        </div>
                        <div class="stage-item">
                            <div class="stage-number">5</div>
                            <div class="stage-label">Astral</div>
                        </div>
                        <div class="stage-item">
                            <div class="stage-number">6</div>
                            <div class="stage-label">Celestial</div>
                        </div>
                        <div class="stage-item">
                            <div class="stage-number">7</div>
                            <div class="stage-label">Divine</div>
                        </div>
                    </div>

                    <p style="margin-top: 20px; line-height: 1.8;">
                        According to Theosophical and Vedantic teachings, every soul must complete exactly 777 incarnations 
                        to achieve moksha (liberation). This sacred number represents the complete spiral of evolution through 
                        seven planes of existence, each containing 111 incarnations.
                    </p>

                    <div class="accordion" style="margin-top: 30px;">
                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <span>The Mathematics of Soul Evolution</span>
                                <span>‚ñº</span>
                            </div>
                            <div class="accordion-content">
                                <p><strong>777 = 7 √ó 111</strong></p>
                                <p>Seven represents the cosmic planes of existence</p>
                                <p>111 represents the trinity (1+1+1) at each level</p>
                                <p>Together they form the complete journey of consciousness</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 5: Soul Stages -->
            <div id="stages-tab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">üé≠</span>
                        <h2 class="section-title">The Seven Stages of Soul Development</h2>
                    </div>

                    <div class="result-card">
                        <h3>Stage 1: Infant Soul (Incarnations 1-111)</h3>
                        <p>The soul begins its journey, learning basic survival and experiencing physical existence for the first time. Focus is on understanding the material world and basic cause-and-effect relationships.</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Primary lesson: Physical survival</li>
                            <li>Consciousness: Instinctual</li>
                            <li>Challenge: Fear and basic needs</li>
                        </ul>
                    </div>

                    <div class="result-card">
                        <h3>Stage 2: Baby Soul (Incarnations 112-222)</h3>
                        <p>The soul develops social awareness and begins to understand rules, structure, and authority. Strong focus on tradition, family, and belonging to a group.</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Primary lesson: Social structure</li>
                            <li>Consciousness: Conformist</li>
                            <li>Challenge: Rigidity and judgment</li>
                        </ul>
                    </div>

                    <div class="result-card">
                        <h3>Stage 3: Young Soul (Incarnations 223-333)</h3>
                        <p>The soul seeks independence, success, and recognition. Material achievement and competition become primary drivers.</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Primary lesson: Personal power</li>
                            <li>Consciousness: Competitive</li>
                            <li>Challenge: Ego and materialism</li>
                        </ul>
                    </div>

                    <div class="result-card">
                        <h3>Stage 4: Mature Soul (Incarnations 334-444)</h3>
                        <p>The soul develops emotional depth, empathy, and seeks meaningful relationships. Inner growth becomes more important than outer success.</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Primary lesson: Emotional mastery</li>
                            <li>Consciousness: Relationship-focused</li>
                            <li>Challenge: Emotional intensity</li>
                        </ul>
                    </div>

                    <div class="result-card">
                        <h3>Stage 5: Old Soul (Incarnations 445-555)</h3>
                        <p>The soul seeks spiritual understanding and sees the bigger picture. Detachment from material concerns and focus on wisdom.</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Primary lesson: Spiritual truth</li>
                            <li>Consciousness: Philosophical</li>
                            <li>Challenge: Isolation and detachment</li>
                        </ul>
                    </div>

                    <div class="result-card">
                        <h3>Stage 6: Transcendent Soul (Incarnations 556-666)</h3>
                        <p>The soul begins to merge with universal consciousness. Service to humanity and teaching become primary purposes.</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Primary lesson: Universal love</li>
                            <li>Consciousness: Transpersonal</li>
                            <li>Challenge: Balancing heaven and earth</li>
                        </ul>
                    </div>

                    <div class="result-card">
                        <h3>Stage 7: Infinite Soul (Incarnations 667-777)</h3>
                        <p>The final stage before liberation. The soul embodies divine consciousness and prepares for moksha.</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Primary lesson: Divine unity</li>
                            <li>Consciousness: Cosmic</li>
                            <li>Challenge: Final karmic resolution</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Tab 6: Vedantic Teachings -->
            <div id="vedantic-tab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">üïâÔ∏è</span>
                        <h2 class="section-title">Vedantic Philosophy of Soul Evolution</h2>
                    </div>

                    <div class="wisdom-quote">
                        "As a person puts on new garments, giving up old ones, the soul similarly accepts new material bodies, giving up the old and useless ones." - Bhagavad Gita 2.22
                    </div>

                    <h3 style="color: var(--primary); margin: 20px 0;">The Four Purusharthas (Life Goals)</h3>
                    
                    <div class="karaka-grid">
                        <div class="karaka-card">
                            <div class="karaka-planet">‚öñÔ∏è</div>
                            <div class="karaka-name">Dharma</div>
                            <div class="karaka-meaning">Righteous living and moral values</div>
                        </div>
                        <div class="karaka-card">
                            <div class="karaka-planet">üí∞</div>
                            <div class="karaka-name">Artha</div>
                            <div class="karaka-meaning">Material prosperity and security</div>
                        </div>
                        <div class="karaka-card">
                            <div class="karaka-planet">‚ù§Ô∏è</div>
                            <div class="karaka-name">Kama</div>
                            <div class="karaka-meaning">Pleasure and emotional fulfillment</div>
                        </div>
                        <div class="karaka-card">
                            <div class="karaka-planet">üïäÔ∏è</div>
                            <div class="karaka-name">Moksha</div>
                            <div class="karaka-meaning">Liberation and spiritual realization</div>
                        </div>
                    </div>

                    <h3 style="color: var(--primary); margin: 30px 0 20px;">The Three Gunas (Qualities of Nature)</h3>
                    
                    <div class="result-card">
                        <p><strong>Sattva (Purity):</strong> Illumination, knowledge, harmony</p>
                        <p><strong>Rajas (Passion):</strong> Activity, desire, ambition</p>
                        <p><strong>Tamas (Inertia):</strong> Darkness, ignorance, lethargy</p>
                        <p style="margin-top: 15px;">The soul's evolution involves gradually increasing Sattva while reducing Rajas and Tamas influences.</p>
                    </div>
                </div>
            </div>

            <!-- Tab 7: Spiritual Guidance -->
            <div id="guidance-tab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">‚ú®</span>
                        <h2 class="section-title">Personalized Spiritual Guidance</h2>
                    </div>
                    <div id="guidanceContent">
                        <p>Calculate your soul age to receive personalized spiritual guidance based on your current incarnation stage.</p>
                        
                        <div class="wisdom-quote">
                            "The journey of a thousand miles begins with a single step. The journey of 777 incarnations begins with knowing where you stand." - Ancient Wisdom
                        </div>

                        <h3 style="color: var(--primary); margin: 20px 0;">General Spiritual Practices for Soul Evolution</h3>
                        
                        <div class="accordion">
                            <div class="accordion-item">
                                <div class="accordion-header" onclick="toggleAccordion(this)">
                                    <span>Daily Meditation Practices</span>
                                    <span>‚ñº</span>
                                </div>
                                <div class="accordion-content">
                                    <p>Regular meditation accelerates soul evolution by:</p>
                                    <ul style="padding-left: 20px; margin-top: 10px;">
                                        <li>Clearing karmic impressions (samskaras)</li>
                                        <li>Developing witness consciousness</li>
                                        <li>Connecting with your higher self</li>
                                        <li>Balancing the three gunas</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <div class="accordion-header" onclick="toggleAccordion(this)">
                                    <span>Karma Yoga - The Path of Action</span>
                                    <span>‚ñº</span>
                                </div>
                                <div class="accordion-content">
                                    <p>Perform actions without attachment to results:</p>
                                    <ul style="padding-left: 20px; margin-top: 10px;">
                                        <li>Selfless service (seva)</li>
                                        <li>Dedication of actions to the Divine</li>
                                        <li>Maintaining equanimity in success and failure</li>
                                        <li>Acting from dharma, not desire</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 8: FAQ -->
            <div id="faq-tab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">‚ùì</span>
                        <h2 class="section-title">Frequently Asked Questions</h2>
                    </div>

                    <div class="accordion">
                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <span>What is the 777 incarnation system?</span>
                                <span>‚ñº</span>
                            </div>
                            <div class="accordion-content">
                                <p>The 777 incarnation system is based on ancient Vedantic and Theosophical teachings that describe the soul's complete evolutionary journey through 777 lifetimes. This number is considered sacred as it represents 7 planes of existence, each requiring 111 incarnations to master.</p>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <span>How is my soul age calculated?</span>
                                <span>‚ñº</span>
                            </div>
                            <div class="accordion-content">
                                <p>Your soul age is calculated using a combination of:</p>
                                <ul style="padding-left: 20px; margin-top: 10px;">
                                    <li>Numerological analysis of your birth date</li>
                                    <li>Astrological positions at birth</li>
                                    <li>Karmic number calculations</li>
                                    <li>Sacred geometry principles</li>
                                    <li>Jaimini astrological techniques</li>
                                </ul>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <span>What are Jaimini Karakas?</span>
                                <span>‚ñº</span>
                            </div>
                            <div class="accordion-content">
                                <p>Jaimini Karakas are planetary significators in Vedic astrology that represent different aspects of the soul's journey. The Atmakaraka (soul significator) is the most important, showing the soul's primary desire and lesson in this incarnation. Other karakas represent mind, siblings, parents, children, spouse, and obstacles.</p>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <span>Can I change my soul age?</span>
                                <span>‚ñº</span>
                            </div>
                            <div class="accordion-content">
                                <p>Your soul age represents your current position in the 777 incarnation journey and cannot be changed within a single lifetime. However, you can accelerate your spiritual evolution through dedicated practice, potentially reducing the number of future incarnations needed to reach liberation.</p>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <span>What if I'm in my last incarnations?</span>
                                <span>‚ñº</span>
                            </div>
                            <div class="accordion-content">
                                <p>Souls in their final incarnations (667-777) often experience:</p>
                                <ul style="padding-left: 20px; margin-top: 10px;">
                                    <li>Strong desire for spiritual liberation</li>
                                    <li>Natural detachment from material concerns</li>
                                    <li>Profound wisdom and understanding</li>
                                    <li>Ability to see through maya (illusion)</li>
                                    <li>Deep compassion for all beings</li>
                                    <li>Spontaneous spiritual experiences</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Google Maps Places Autocomplete
        let autocomplete;
        let currentLocationData = null;
        let searchTimeout = null;
        let calculationData = null;

        function initAutocomplete() {
            const input = document.getElementById('birthLocation');
            
            // Create autocomplete instance
            autocomplete = new google.maps.places.Autocomplete(input, {
                types: ['(cities)'],
                fields: ['address_components', 'geometry', 'name', 'formatted_address']
            });

            // Listen for place selection
            autocomplete.addListener('place_changed', function() {
                const place = autocomplete.getPlace();
                
                if (!place.geometry) {
                    showError('locationError', 'Please select a valid location from the dropdown');
                    showValidation('locationValidation', false);
                    currentLocationData = null;
                    return;
                }

                // Store location data
                currentLocationData = {
                    name: place.formatted_address || place.name,
                    lat: place.geometry.location.lat(),
                    lng: place.geometry.location.lng(),
                    components: place.address_components
                };

                // Validate location
                validateLocation();
            });

            // Add input event listener for validation
            input.addEventListener('input', function() {
                // Clear location data when user types
                currentLocationData = null;
                showValidation('locationValidation', false);
            });
        }

        // Tab switching
        function switchTab(tabName) {
            // Hide all tab contents
            const allTabs = document.querySelectorAll('.tab-content');
            allTabs.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all tab buttons
            const allButtons = document.querySelectorAll('.tab');
            allButtons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // Add active class to clicked button
            event.currentTarget.classList.add('active');
        }

        // Accordion toggle
        function toggleAccordion(header) {
            const content = header.nextElementSibling;
            const isOpen = content.classList.contains('show');
            
            // Close all accordions in the same container
            const container = header.closest('.accordion');
            container.querySelectorAll('.accordion-content').forEach(c => {
                c.classList.remove('show');
            });
            container.querySelectorAll('.accordion-header').forEach(h => {
                h.classList.remove('active');
            });
            
            // Open clicked accordion if it was closed
            if (!isOpen) {
                content.classList.add('show');
                header.classList.add('active');
            }
        }

        // Validation functions
        function validateDate() {
            const day = parseInt(document.getElementById('birthDay').value);
            const month = parseInt(document.getElementById('birthMonth').value);
            const year = parseInt(document.getElementById('birthYear').value);
            
            // Check if all fields are filled
            if (!day || !month || !year) {
                showError('dateError', 'Please fill in all date fields');
                showValidation('dateValidation', false);
                return false;
            }

            // Validate year range
            const currentYear = new Date().getFullYear();
            if (year < 1874 || year > currentYear) {
                showError('dateError', `Year must be between 1874 and ${currentYear}`);
                showValidation('dateValidation', false);
                return false;
            }

            // Smart day validation based on month
            const daysInMonth = getDaysInMonth(month, year);
            if (day < 1 || day > daysInMonth) {
                showError('dateError', `Day must be between 1 and ${daysInMonth} for the selected month`);
                showValidation('dateValidation', false);
                return false;
            }

            // Create date object to validate
            const date = new Date(year, month - 1, day);
            const now = new Date();
            
            if (date > now) {
                showError('dateError', 'Birth date cannot be in the future');
                showValidation('dateValidation', false);
                return false;
            }

            // All validations passed
            hideError('dateError');
            showValidation('dateValidation', true);
            return true;
        }

        function getDaysInMonth(month, year) {
            const monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
            
            // Check for leap year (February)
            if (month === 2 && isLeapYear(year)) {
                return 29;
            }
            
            return monthDays[month - 1];
        }

        function isLeapYear(year) {
            return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);
        }

        function validateTime() {
            const hour = document.getElementById('birthHour').value;
            const minute = document.getElementById('birthMinute').value;
            const ampm = document.getElementById('ampm').value;
            
            // Time is completely optional
            if (!hour && !minute && !ampm) {
                showValidation('timeValidation', true);
                hideError('timeError');
                return true;
            }
            
            // If any time field is filled, validate properly
            if (hour || minute || ampm) {
                // Check if all required time fields are filled
                if (!hour || !ampm) {
                    showError('timeError', 'Please select hour and AM/PM');
                    showValidation('timeValidation', false);
                    return false;
                }
                
                // Validate minute if provided
                if (minute !== '' && (parseInt(minute) < 0 || parseInt(minute) > 59)) {
                    showError('timeError', 'Minutes must be between 0 and 59');
                    showValidation('timeValidation', false);
                    return false;
                }
            }
            
            hideError('timeError');
            showValidation('timeValidation', true);
            return true;
        }

        function validateLocation() {
            const input = document.getElementById('birthLocation');
            
            if (!input.value.trim()) {
                showError('locationError', 'Birth location is required');
                showValidation('locationValidation', false);
                return false;
            }
            
            if (!currentLocationData) {
                showError('locationError', 'Please select a location from the dropdown');
                showValidation('locationValidation', false);
                return false;
            }
            
            hideError('locationError');
            showValidation('locationValidation', true);
            return true;
        }

        function useUnknownTime() {
            // Set time to noon
            document.getElementById('birthHour').value = '12';
            document.getElementById('birthMinute').value = '0';
            document.getElementById('ampm').value = 'PM';
            
            // Validate
            validateTime();
        }

        // Helper functions
        function showValidation(id, isValid) {
            const icon = document.getElementById(id);
            if (isValid) {
                icon.textContent = '‚úì';
                icon.className = 'validation-icon valid';
            } else {
                icon.textContent = '‚úó';
                icon.className = 'validation-icon invalid';
            }
        }

        function showError(id, message) {
            const errorElement = document.getElementById(id);
            errorElement.textContent = message;
            errorElement.classList.add('show');
        }

        function hideError(id) {
            const errorElement = document.getElementById(id);
            errorElement.classList.remove('show');
        }

        // Calculate Soul Age
        function calculateSoulAge() {
            // Validate all fields
            const isDateValid = validateDate();
            const isTimeValid = validateTime();
            const isLocationValid = validateLocation();
            
            if (!isDateValid || !isTimeValid || !isLocationValid) {
                alert('Please correct the errors in the form before calculating.');
                return;
            }
            
            // Get form values
            const day = parseInt(document.getElementById('birthDay').value);
            const month = parseInt(document.getElementById('birthMonth').value);
            const year = parseInt(document.getElementById('birthYear').value);
            const hour = parseInt(document.getElementById('birthHour').value) || 12;
            const minute = parseInt(document.getElementById('birthMinute').value) || 0;
            const ampm = document.getElementById('ampm').value || 'PM';
            
            // Convert to 24-hour format
            let hour24 = hour;
            if (ampm === 'PM' && hour !== 12) hour24 += 12;
            if (ampm === 'AM' && hour === 12) hour24 = 0;
            
            // Calculate soul age using complex algorithm
            const birthDate = new Date(year, month - 1, day, hour24, minute);
            const soulAge = calculateSoulNumber(birthDate, currentLocationData);
            
            // Store calculation data
            calculationData = {
                birthDate: birthDate,
                location: currentLocationData,
                soulAge: soulAge,
                karakas: calculateJaiminiKarakas(birthDate, currentLocationData)
            };
            
            // Display results
            displayResults(calculationData);
            
            // Update other tabs with personalized content
            updateJaiminiTab(calculationData);
            updateDetailedTab(calculationData);
            updateGuidanceTab(calculationData);
        }

        function calculateSoulNumber(birthDate, location) {
            // Complex soul age calculation algorithm
            const day = birthDate.getDate();
            const month = birthDate.getMonth() + 1;
            const year = birthDate.getFullYear();
            const hour = birthDate.getHours();
            const minute = birthDate.getMinutes();
            
            // Numerological reduction
            let lifePathNumber = 0;
            const dateString = `${day}${month}${year}`;
            for (let digit of dateString) {
                lifePathNumber += parseInt(digit);
            }
            while (lifePathNumber > 9 && lifePathNumber !== 11 && lifePathNumber !== 22) {
                lifePathNumber = lifePathNumber.toString().split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
            }
            
            // Karmic number calculation
            const karmicDebt = [13, 14, 16, 19].includes(day + month) ? 50 : 0;
            
            // Location-based adjustment
            const latAdjustment = Math.abs(location.lat) / 90 * 100;
            const lngAdjustment = Math.abs(location.lng) / 180 * 100;
            
            // Time-based calculation
            const timeValue = (hour * 60 + minute) / 1440 * 100;
            
            // Calculate incarnation number (1-777)
            let incarnationNumber = Math.floor(
                (lifePathNumber * 77.7) + 
                (year % 777) + 
                (month * day) + 
                latAdjustment + 
                lngAdjustment + 
                timeValue - 
                karmicDebt
            ) % 777;
            
            if (incarnationNumber === 0) incarnationNumber = 1;
            
            // Determine soul stage
            let stage, stageLevel;
            if (incarnationNumber <= 111) {
                stage = 'Infant Soul';
                stageLevel = 1;
            } else if (incarnationNumber <= 222) {
                stage = 'Baby Soul';
                stageLevel = 2;
            } else if (incarnationNumber <= 333) {
                stage = 'Young Soul';
                stageLevel = 3;
            } else if (incarnationNumber <= 444) {
                stage = 'Mature Soul';
                stageLevel = 4;
            } else if (incarnationNumber <= 555) {
                stage = 'Old Soul';
                stageLevel = 5;
            } else if (incarnationNumber <= 666) {
                stage = 'Transcendent Soul';
                stageLevel = 6;
            } else {
                stage = 'Infinite Soul';
                stageLevel = 7;
            }
            
            // Calculate progress within current stage
            const stageStart = (stageLevel - 1) * 111 + 1;
            const progressInStage = ((incarnationNumber - stageStart + 1) / 111 * 100).toFixed(1);
            
            // Calculate remaining incarnations
            const remainingIncarnations = 777 - incarnationNumber;
            
            return {
                incarnationNumber: incarnationNumber,
                stage: stage,
                stageLevel: stageLevel,
                progressInStage: progressInStage,
                remainingIncarnations: remainingIncarnations,
                lifePathNumber: lifePathNumber,
                karmicDebt: karmicDebt > 0
            };
        }

        function calculateJaiminiKarakas(birthDate, location) {
            // Simplified Jaimini Karaka calculation
            // In real implementation, this would use actual planetary positions
            const planets = ['Sun', 'Moon', 'Mars', 'Mercury', 'Jupiter', 'Venus', 'Saturn', 'Rahu'];
            const karakas = [
                'Atmakaraka (Soul)',
                'Amatyakaraka (Mind/Career)',
                'Bhratrikaraka (Siblings)',
                'Matrikaraka (Mother)',
                'Pitrikaraka (Father)',
                'Putrakaraka (Children)',
                'Gnatikaraka (Obstacles)',
                'Darakaraka (Spouse)'
            ];
            
            // Generate pseudo-random but consistent planet assignments based on birth data
            const seed = birthDate.getTime() + location.lat + location.lng;
            const shuffledPlanets = planets.sort(() => {
                return Math.sin(seed) - 0.5;
            });
            
            const karakaAssignments = {};
            karakas.forEach((karaka, index) => {
                karakaAssignments[karaka] = shuffledPlanets[index];

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soul Age Calculator - Vedantic & Theosophical Analysis</title>
    
    <!-- Security Headers via Meta Tags -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://maps.googleapis.com https://maps.gstatic.com; script-src 'self' 'unsafe-inline' https://maps.googleapis.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; img-src 'self' data: https://maps.googleapis.com https://maps.gstatic.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self' https://maps.googleapis.com; frame-ancestors 'none';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="no-referrer">
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">
    
    <!-- SEO & Privacy Compliant Meta Tags -->
    <meta name="description" content="Discover your soul's evolutionary journey through 777 incarnations using Vedantic wisdom and Theosophical teachings. GDPR-compliant, no data storage.">
    <meta name="keywords" content="soul age, 777 incarnations, Vedanta, Theosophy, spiritual evolution, Jaimini astrology, karma, reincarnation">
    <meta name="author" content="Soul Age Calculator">
    <meta name="robots" content="index, follow">
    
    <!-- Privacy & Security -->
    <meta name="privacy" content="No user data collected or stored">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Soul Age Calculator - Discover Your Spiritual Evolution">
    <meta property="og:description" content="Calculate your position in the 777-incarnation journey using ancient Vedantic and Theosophical wisdom.">
    
    <style>
        :root {
            --primary: #8B5CF6;
            --secondary: #06B6D4;
            --accent: #F59E0B;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --text: #1F2937;
            --bg: #F9FAFB;
            --white: #FFFFFF;
            --border: #E5E7EB;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--text);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--white);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .title {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        .tabs {
            display: flex;
            background: var(--bg);
            border-bottom: 2px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            background: transparent;
            border: none;
            color: var(--text);
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
        }

        .tab:hover {
            background: rgba(139, 92, 246, 0.05);
        }

        .tab.active {
            color: var(--primary);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary);
        }

        .content {
            padding: 40px;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            background: var(--bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border);
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border);
        }

        .section-icon {
            font-size: 1.8rem;
            margin-right: 15px;
        }

        .section-title {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .input-group {
            margin-bottom: 25px;
            position: relative;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text);
            font-size: 0.95rem;
        }

        .input-field {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--white);
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .date-input-grid {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 15px;
            align-items: end;
        }

        .time-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .validation-icon {
            position: absolute;
            right: 15px;
            top: 42px;
            font-size: 1.2rem;
            display: none;
        }

        .validation-icon.valid {
            color: var(--success);
            display: block;
        }

        .validation-icon.invalid {
            color: var(--error);
            display: block;
        }

        .error-message {
            color: var(--error);
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .location-input-container {
            position: relative;
        }

        .pac-container {
            background-color: var(--white);
            border: 2px solid var(--border);
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-top: 5px;
            font-family: 'Georgia', serif;
        }

        .pac-item {
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .pac-item:hover {
            background: var(--bg);
        }

        .pac-item:last-child {
            border-bottom: none;
        }

        .pac-item-query {
            font-size: 0.95rem;
            color: var(--text);
        }

        .pac-matched {
            font-weight: bold;
            color: var(--primary);
        }

        .pac-item-query .pac-matched {
            color: var(--primary);
        }

        .unknown-time-btn {
            width: 100%;
            padding: 10px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .unknown-time-btn:hover {
            background: #0891B2;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .calculate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 30px;
        }

        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(139, 92, 246, 0.3);
        }

        .calculate-btn:active {
            transform: translateY(-1px);
        }

        .results-container {
            display: none;
            margin-top: 40px;
        }

        .results-container.show {
            display: block;
            animation: slideUp 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }

        .tooltip-icon {
            color: var(--primary);
            font-size: 0.9rem;
        }

        .tooltip-text {
            visibility: hidden;
            width: 250px;
            background-color: var(--text);
            color: var(--white);
            text-align: left;
            border-radius: 8px;
            padding: 10px;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 1.8rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .date-input-grid,
            .time-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">🕉️ Soul Age Calculator</h1>
            <p class="subtitle">Discover Your Position in the 777-Incarnation Journey</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('calculator')">
                <span>📊 Calculator</span>
            </button>
            <button class="tab" onclick="switchTab('wisdom')">
                <span>📚 Ancient Wisdom</span>
            </button>
            <button class="tab" onclick="switchTab('knowledge')">
                <span>🔮 Knowledge Base</span>
            </button>
            <button class="tab" onclick="switchTab('faq')">
                <span>❓ FAQ</span>
            </button>
        </div>

        <div class="content">
            <!-- Tab 1: Calculator -->
            <div id="calculator-tab" class="tab-content active">
                <!-- Birth Information -->
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">📅</span>
                        <h2 class="section-title">Birth Information</h2>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Birth Date *</label>
                        <div class="date-input-grid">
                            <div>
                                <label style="font-size: 0.9rem; color: #6B7280;">Day</label>
                                <input type="number" 
                                       id="birthDay" 
                                       class="input-field" 
                                       placeholder="DD" 
                                       min="1" 
                                       max="31"
                                       onchange="validateDate()"
                                       oninput="validateDate()"
                                       required>
                            </div>
                            <div>
                                <label style="font-size: 0.9rem; color: #6B7280;">Month</label>
                                <select id="birthMonth" class="input-field" onchange="validateDate()" required>
                                    <option value="">Select Month</option>
                                    <option value="1">January</option>
                                    <option value="2">February</option>
                                    <option value="3">March</option>
                                    <option value="4">April</option>
                                    <option value="5">May</option>
                                    <option value="6">June</option>
                                    <option value="7">July</option>
                                    <option value="8">August</option>
                                    <option value="9">September</option>
                                    <option value="10">October</option>
                                    <option value="11">November</option>
                                    <option value="12">December</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size: 0.9rem; color: #6B7280;">Year</label>
                                <input type="number" 
                                       id="birthYear" 
                                       class="input-field" 
                                       placeholder="YYYY" 
                                       min="1874"
                                       max="2025"
                                       onchange="validateDate()"
                                       oninput="validateDate()"
                                       required>
                            </div>
                        </div>
                        <span id="dateValidation" class="validation-icon">✓</span>
                        <div id="dateError" class="error-message"></div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Birth Time (Optional - defaults to noon if not provided)</label>
                        <div class="time-grid">
                            <div>
                                <label style="font-size: 0.9rem; color: #6B7280;">Hour</label>
                                <select id="birthHour" class="input-field" onchange="validateTime()">
                                    <option value="">Hour</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size: 0.9rem; color: #6B7280;">Minute</label>
                                <input type="number" id="birthMinute" class="input-field" 
                                       placeholder="MM" 
                                       min="0" 
                                       max="59" 
                                       onchange="validateTime()"
                                       oninput="validateTime()">
                            </div>
                            <div>
                                <label style="font-size: 0.9rem; color: #6B7280;">AM/PM</label>
                                <select id="ampm" class="input-field" onchange="validateTime()">
                                    <option value="">Select</option>
                                    <option value="AM">AM</option>
                                    <option value="PM">PM</option>
                                </select>
                            </div>
                        </div>
                        <button type="button" class="unknown-time-btn" onclick="useUnknownTime()">
                            Don't Know Time - Use Noon
                        </button>
                        <span id="timeValidation" class="validation-icon">✓</span>
                        <div id="timeError" class="error-message"></div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Birth Location *</label>
                        <div class="location-input-container">
                            <input type="text" 
                                   id="birthLocation" 
                                   class="input-field" 
                                   placeholder="e.g., New York, London, Mumbai..."
                                   autocomplete="off"
                                   required>
                        </div>
                        <span id="locationValidation" class="validation-icon">✓</span>
                        <div id="locationError" class="error-message"></div>
                    </div>
                </div>

                <button class="calculate-btn" onclick="calculateSoulAge()">
                    Calculate Soul Age 🔮
                </button>

                <div id="results" class="results-container"></div>
            </div>

            <!-- Tab 2: Ancient Wisdom -->
            <div id="wisdom-tab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">📖</span>
                        <h2 class="section-title">The 777 Incarnation Journey</h2>
                    </div>
                    <p>According to Vedantic and Theosophical teachings, the soul undergoes 777 incarnations in its evolutionary journey from mineral to divine consciousness. This sacred number represents the complete cycle of spiritual evolution through various planes of existence.</p>
                </div>
            </div>

            <!-- Tab 3: Knowledge Base -->
            <div id="knowledge-tab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">🔮</span>
                        <h2 class="section-title">Understanding Your Soul Age</h2>
                    </div>
                    <p>The soul age calculation combines ancient wisdom with metaphysical principles to provide insights into your spiritual evolution.</p>
                </div>
            </div>

            <!-- Tab 4: FAQ -->
            <div id="faq-tab" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">❓</span>
                        <h2 class="section-title">Frequently Asked Questions</h2>
                    </div>
                    <p>Find answers to common questions about soul age calculation and spiritual evolution.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Google Maps Places API -->
    <script>
        // Initialize Google Maps Places Autocomplete
        let autocomplete;
        let currentLocationData = null;
        let searchTimeout = null;

        function initAutocomplete() {
            const input = document.getElementById('birthLocation');
            
            // Create autocomplete instance
            autocomplete = new google.maps.places.Autocomplete(input, {
                types: ['(cities)'],
                fields: ['address_components', 'geometry', 'name', 'formatted_address']
            });

            // Listen for place selection
            autocomplete.addListener('place_changed', function() {
                const place = autocomplete.getPlace();
                
                if (!place.geometry) {
                    showError('locationError', 'Please select a valid location from the dropdown');
                    showValidation('locationValidation', false);
                    currentLocationData = null;
                    return;
                }

                // Store location data
                currentLocationData = {
                    name: place.formatted_address || place.name,
                    lat: place.geometry.location.lat(),
                    lng: place.geometry.location.lng(),
                    components: place.address_components
                };

                // Validate location
                validateLocation();
            });

            // Add input event listener for validation
            input.addEventListener('input', function() {
                // Clear location data when user types
                currentLocationData = null;
                showValidation('locationValidation', false);
            });
        }

        // Tab switching
        function switchTab(tabName) {
            // Hide all tab contents
            const allTabs = document.querySelectorAll('.tab-content');
            allTabs.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all tab buttons
            const allButtons = document.querySelectorAll('.tab');
            allButtons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // Add active class to clicked button
            event.currentTarget.classList.add('active');
        }

        // Validation functions
        function validateDate() {
            const day = parseInt(document.getElementById('birthDay').value);
            const month = parseInt(document.getElementById('birthMonth').value);
            const year = parseInt(document.getElementById('birthYear').value);
            
            // Check if all fields are filled
            if (!day || !month || !year) {
                showError('dateError', 'Please fill in all date fields');
                showValidation('dateValidation', false);
                return false;
            }

            // Validate year range
            const currentYear = new Date().getFullYear();
            if (year < 1874 || year > currentYear) {
                showError('dateError', `Year must be between 1874 and ${currentYear}`);
                showValidation('dateValidation', false);
                return false;
            }

            // Smart day validation based on month
            const daysInMonth = getDaysInMonth(month, year);
            if (day < 1 || day > daysInMonth) {
                showError('dateError', `Day must be between 1 and ${daysInMonth} for the selected month`);
                showValidation('dateValidation', false);
                return false;
            }

            // Create date object to validate
            const date = new Date(year, month - 1, day);
            const now = new Date();
            
            if (date > now) {
                showError('dateError', 'Birth date cannot be in the future');
                showValidation('dateValidation', false);
                return false;
            }

            // All validations passed
            hideError('dateError');
            showValidation('dateValidation', true);
            return true;
        }

        function getDaysInMonth(month, year) {
            const monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
            
            // Check for leap year (February)
            if (month === 2 && isLeapYear(year)) {
                return 29;
            }
            
            return monthDays[month - 1];
        }

        function isLeapYear(year) {
            return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);
        }

        function validateTime() {
            const hour = document.getElementById('birthHour').value;
            const minute = document.getElementById('birthMinute').value;
            const ampm = document.getElementById('ampm').value;
            
            // Time is completely optional
            if (!hour && !minute && !ampm) {
                showValidation('timeValidation', true);
                hideError('timeError');
                return true;
            }
            
            // If any time field is filled, validate properly
            if (hour || minute || ampm) {
                // Check if all required time fields are filled
                if (!hour || !ampm) {
                    showError('timeError', 'Please select hour and AM/PM');
                    showValidation('timeValidation', false);
                    return false;
                }
                
                // Validate minute if provided
                if (minute !== '' && (parseInt(minute) < 0 || parseInt(minute) > 59)) {
                    showError('timeError', 'Minutes must be between 0 and 59');
                    showValidation('timeValidation', false);
                    return false;
                }
            }
            
            hideError('timeError');
            showValidation('timeValidation', true);
            return true;
        }

        function validateLocation() {
            const input = document.getElementById('birthLocation');
            
            if (!input.value.trim()) {
                showError('locationError', 'Birth location is required');
                showValidation('locationValidation', false);
                return false;
            }
            
            if (!currentLocationData) {
                showError('locationError', 'Please select a location from the dropdown');
                showValidation('locationValidation', false);
                return false;
            }
            
            hideError('locationError');
            showValidation('locationValidation', true);
            return true;
        }

        function useUnknownTime() {
            // Set time to noon
            document.getElementById('birthHour').value = '12';
            document.getElementById('birthMinute').value = '0';
            document.getElementById('ampm').value = 'PM';
            
            // Validate
            validateTime();
        }

        // Helper functions
        function showValidation(id, isValid) {
            const icon = document.getElementById(id);
            if (isValid) {
                icon.textContent = '✓';
                icon.className = 'validation-icon valid';
            } else {
                icon.textContent = '✗';
                icon.className = 'validation-icon invalid';
            }
        }

        function showError(id, message) {
            const errorElement = document.getElementById(id);
            errorElement.textContent = message;
            errorElement.classList.add('show');
        }

        function hideError(id) {
            const errorElement = document.getElementById(id);
            errorElement.classList.remove('show');
        }

        function calculateSoulAge() {
            // Validate all fields
            const isDateValid = validateDate();
            const isTimeValid = validateTime();
            const isLocationValid = validateLocation();
            
            if (!isDateValid || !isTimeValid || !isLocationValid) {
                alert('Please correct the errors in the form before calculating.');
                return;
            }
            
            // Get form values
            const day = document.getElementById('birthDay').value;
            const month = document.getElementById('birthMonth').value;
            const year = document.getElementById('birthYear').value;
            const hour = document.getElementById('birthHour').value || '12';
            const minute = document.getElementById('birthMinute').value || '0';
            const ampm = document.getElementById('ampm').value || 'PM';
            
            // Show results
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = `
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">✨</span>
                        <h2 class="section-title">Your Soul Age Results</h2>
                    </div>
                    <p><strong>Birth Date:</strong> ${day}/${month}/${year}</p>
                    <p><strong>Birth Time:</strong> ${hour}:${minute.padStart(2, '0')} ${ampm}</p>
                    <p><strong>Birth Location:</strong> ${currentLocationData.name}</p>
                    <p><strong>Coordinates:</strong> ${currentLocationData.lat.toFixed(4)}, ${currentLocationData.lng.toFixed(4)}</p>
                    <p style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%); border-radius: 10px;">
                        <strong>🔮 Soul Age Calculation:</strong> Based on your birth information, your soul age will be calculated using ancient Vedantic and Theosophical principles...
                    </p>
                </div>
            `;
            resultsContainer.classList.add('show');
        }
    </script>

    <!-- Load Google Maps JavaScript API -->
    <!-- IMPORTANT: Replace YOUR_API_KEY with your actual Google Maps API key -->
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places&callback=initAutocomplete">
    </script>
</body>
</html>

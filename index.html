<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soul Age Calculator - Vedantic & Theosophical Analysis</title>
    
    <!-- Security Headers via Meta Tags -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://nominatim.openstreetmap.org; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self' https://nominatim.openstreetmap.org; frame-ancestors 'none';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="no-referrer">
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">
    
    <!-- SEO & Privacy Compliant Meta Tags -->
    <meta name="description" content="Discover your soul's evolutionary journey through 777 incarnations using Vedantic wisdom and Theosophical teachings. GDPR-compliant, no data storage.">
    <meta name="keywords" content="soul age, 777 incarnations, Vedanta, Theosophy, spiritual evolution, Jaimini astrology, karma, reincarnation">
    <meta name="author" content="Soul Age Calculator">
    <meta name="robots" content="index, follow">
    
    <!-- Privacy & Security -->
    <meta name="privacy" content="No user data collected or stored">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Soul Age Calculator - Discover Your Spiritual Evolution">
    <meta property="og:description" content="Calculate your position in the 777-incarnation journey using ancient Vedantic and Theosophical wisdom.">
    
    <style>
        :root {
            --primary: #8B5CF6;
            --secondary: #06B6D4;
            --accent: #F59E0B;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --text: #1F2937;
            --text-light: #6B7280;
            --border: #E5E7EB;
            --bg-light: #F9FAFB;
            --shadow: rgba(0, 0, 0, 0.1);
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            --sacred-gold: #D97706;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 35px var(--shadow);
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 3rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header .subtitle {
            color: #6B7280;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .privacy-notice {
            display: inline-block;
            background: #10B98120;
            color: #065F46;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        /* Tabs Navigation */
        .tabs-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.95);
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 10px 25px var(--shadow);
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-btn {
            padding: 12px 24px;
            background: transparent;
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: #6B7280;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            background: #F3F4F6;
        }

        .tab-btn.active {
            background: var(--gradient);
            color: white;
            border-color: transparent;
        }

        .tab-icon {
            font-size: 1.2rem;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Sections */
        .section {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px var(--shadow);
            position: relative;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--bg-light);
        }

        .section-icon {
            font-size: 2rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .section-title {
            font-size: 1.8rem;
            color: var(--text);
            font-weight: 700;
        }

        /* Form Styles */
        .input-group {
            margin-bottom: 25px;
        }

        .input-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .input-field {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .time-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .unknown-time-btn {
            background: var(--bg-light);
            color: var(--text-light);
            padding: 10px 20px;
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .unknown-time-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .location-input-container {
            position: relative;
        }

        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid var(--border);
            border-top: none;
            border-radius: 0 0 12px 12px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 5px 15px var(--shadow);
        }

        .autocomplete-item {
            padding: 12px 15px;
            cursor: pointer;
            border-bottom: 1px solid var(--border);
            transition: background 0.2s;
        }

        .autocomplete-item:hover {
            background: #F3F4F6;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .autocomplete-item .location-name {
            font-weight: 600;
            color: var(--text);
        }

        .autocomplete-item .location-details {
            display: block;
            font-size: 0.85rem;
            color: #6B7280;
            margin-top: 2px;
        }

        .search-status {
            padding: 10px 15px;
            color: #6B7280;
            font-size: 0.9rem;
            text-align: center;
            border-bottom: 1px solid var(--border);
        }

        .search-status.loading {
            color: var(--primary);
        }

        /* Survey Questions */
        .survey-grid {
            display: grid;
            gap: 15px;
            margin-bottom: 20px;
        }

        .question-card {
            background: #F9FAFB;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
        }

        .question-text {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text);
        }

        .question-card select {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: white;
            cursor: pointer;
        }

        /* Questions explanation styles */
        .questions-explanation {
            display: grid;
            gap: 20px;
            margin: 25px 0;
        }

        .question-explanation-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .question-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 12px;
        }

        .spiritual-basis {
            color: var(--text);
            line-height: 1.6;
        }

        .spiritual-basis strong {
            color: var(--sacred-gold);
        }

        .spiritual-basis ul {
            margin-top: 8px;
        }

        .spiritual-basis li {
            margin-bottom: 5px;
            font-size: 0.95rem;
        }

        /* Validation */
        .validation-icon {
            display: none;
            font-size: 1.2rem;
            margin-left: 10px;
        }

        .validation-icon.valid {
            display: inline;
            color: var(--success);
        }

        .validation-icon.invalid {
            display: inline;
            color: var(--error);
        }

        .error-message {
            display: none;
            color: var(--error);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .error-message.show {
            display: block;
        }

        /* Calculate Button */
        .calculate-btn {
            background: var(--gradient);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            min-width: 250px;
            box-shadow: 0 10px 25px rgba(147, 51, 234, 0.3);
        }

        .calculate-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(147, 51, 234, 0.4);
        }

        .calculate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Results Display */
        .results-container {
            display: none;
            margin-top: 30px;
        }

        .results-container.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .soul-age-display {
            background: var(--gradient);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .soul-age-display::before {
            content: '☸';
            position: absolute;
            top: -50px;
            right: -50px;
            font-size: 200px;
            opacity: 0.1;
        }

        .soul-age-number {
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .soul-stage {
            font-size: 1.5rem;
            margin-bottom: 20px;
            opacity: 0.95;
        }

        .soul-stage-description {
            font-size: 1.1rem;
            margin-bottom: 25px;
            opacity: 0.9;
            line-height: 1.6;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .incarnation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Stage Descriptions Section */
        .stage-description-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            border-left: 5px solid var(--primary);
        }

        .stage-description-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .stage-description-text {
            line-height: 1.7;
            color: var(--text);
            margin-bottom: 15px;
        }

        .stage-traits {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .trait-group {
            background: var(--bg-light);
            padding: 15px;
            border-radius: 10px;
        }

        .trait-title {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .trait-list {
            font-size: 0.95rem;
            color: var(--text-light);
            line-height: 1.5;
        }

        /* Confidence Indicators */
        .confidence-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .confidence-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }

        .confidence-dot.confidence-high {
            background: var(--success);
        }

        .confidence-dot.confidence-medium {
            background: var(--warning);
        }

        .confidence-dot.confidence-low {
            background: var(--error);
        }

        .confidence-text {
            font-weight: 600;
            color: white;
        }

        /* Understanding Tab Styles */
        .wisdom-card {
            background: linear-gradient(135deg, #F9FAFB 0%, #F3F4F6 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border-left: 5px solid var(--sacred-gold);
        }

        .wisdom-header {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 15px;
        }

        .evolution-stages {
            display: grid;
            gap: 20px;
            margin-top: 25px;
        }

        .stage-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px var(--shadow);
            border-left: 4px solid;
        }

        .stage-card.infant { border-left-color: #EF4444; }
        .stage-card.baby { border-left-color: #F59E0B; }
        .stage-card.young { border-left-color: #10B981; }
        .stage-card.mature { border-left-color: #3B82F6; }
        .stage-card.old { border-left-color: #8B5CF6; }

        .stage-number {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .stage-name {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .stage-range {
            color: var(--text-light);
            font-size: 0.95rem;
            margin-bottom: 15px;
        }

        .stage-traits-list {
            margin-top: 15px;
        }

        .stage-traits-list li {
            margin-bottom: 5px;
            color: var(--text-light);
        }

        /* FAQ Styles */
        .faq-section {
            margin-top: 30px;
        }

        .faq-category {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px var(--shadow);
        }

        .faq-category-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .faq-item {
            border-bottom: 1px solid var(--border);
            padding: 15px 0;
        }

        .faq-item:last-child {
            border-bottom: none;
        }

        .faq-question {
            font-weight: 600;
            color: var(--text);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: color 0.3s ease;
        }

        .faq-question:hover {
            color: var(--primary);
        }

        .faq-answer {
            display: none;
            padding-top: 15px;
            color: var(--text-light);
            line-height: 1.6;
        }

        .faq-answer.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .faq-toggle {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .faq-toggle.rotated {
            transform: rotate(180deg);
        }

        /* Characteristics Display */
        .characteristics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .characteristic-card {
            background: var(--bg-light);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
        }

        .characteristic-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 12px;
        }

        .characteristic-list {
            list-style: none;
        }

        .characteristic-list li {
            padding: 5px 0;
            color: var(--text-light);
            position: relative;
            padding-left: 20px;
        }

        .characteristic-list li:before {
            content: '•';
            color: var(--primary);
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .tabs-nav {
                flex-direction: column;
            }
            
            .time-grid {
                grid-template-columns: 1fr;
            }
            
            .soul-age-number {
                font-size: 3rem;
            }
            
            .incarnation-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>🕉️ Soul Age Calculator</h1>
            <p class="subtitle">Discover Your Position in the 777-Incarnation Journey</p>
            <p style="color: #6B7280; font-size: 0.95rem;">
                Based on Ancient Vedantic Wisdom & Theosophical Teachings
            </p>
            <div class="privacy-notice">
                🔒 Completely Private - No Data Stored
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="tabs-nav">
            <button class="tab-btn active" onclick="switchTab('calculator-tab', this)">
                <span class="tab-icon">🧮</span>
                Calculator
            </button>
            <button class="tab-btn" onclick="switchTab('understanding-tab', this)">
                <span class="tab-icon">🕉️</span>
                Understanding
            </button>
            <button class="tab-btn" onclick="switchTab('jaimini-tab', this)">
                <span class="tab-icon">🔮</span>
                Jaimini Analysis
            </button>
            <button class="tab-btn" onclick="switchTab('faq-tab', this)">
                <span class="tab-icon">❓</span>
                FAQ
            </button>
        </div>

        <!-- Tab 1: Calculator -->
        <div id="calculator-tab" class="tab-content active">
            <!-- Birth Information -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">📅</span>
                    <h2 class="section-title">Birth Information</h2>
                </div>

                <div class="input-group">
                    <label class="input-label">Birth Date *</label>
                    <input type="date" id="birthDate" class="input-field" onchange="validateDate()" required>
                    <span id="dateValidation" class="validation-icon">✓</span>
                    <div id="dateError" class="error-message"></div>
                </div>

                <div class="input-group">
                    <label class="input-label">Birth Time (Optional - defaults to noon if not provided)</label>
                    <div class="time-grid">
                        <div>
                            <label style="font-size: 0.9rem; color: #6B7280;">Hour</label>
                            <select id="birthHour" class="input-field" onchange="validateTime()">
                                <option value="">Hour</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                            </select>
                        </div>
                        <div>
                            <label style="font-size: 0.9rem; color: #6B7280;">Minute</label>
                            <input type="number" id="birthMinute" class="input-field" 
                                   placeholder="Min" 
                                   min="0" 
                                   max="59" 
                                   onchange="validateTime()"
                                   oninput="validateTime()">
                        </div>
                        <div>
                            <label style="font-size: 0.9rem; color: #6B7280;">AM/PM</label>
                            <select id="ampm" class="input-field" onchange="validateTime()">
                                <option value="">AM/PM</option>
                                <option value="AM">AM</option>
                                <option value="PM">PM</option>
                            </select>
                        </div>
                    </div>
                    <button type="button" class="unknown-time-btn" onclick="useUnknownTime()">
                        Don't Know Time - Use Noon
                    </button>
                    <span id="timeValidation" class="validation-icon">✓</span>
                    <div id="timeError" class="error-message"></div>
                </div>

                <div class="input-group">
                    <label class="input-label">Birth Location *</label>
                    <div class="location-input-container">
                        <input type="text" 
                               id="birthLocation" 
                               class="input-field" 
                               placeholder="e.g., New York, London, Mumbai..."
                               onchange="validateLocation()"
                               oninput="searchLocation()"
                               autocomplete="off"
                               required>
                        <div id="locationAutocomplete" class="autocomplete-dropdown"></div>
                    </div>
                    <span id="locationValidation" class="validation-icon">✓</span>
                    <div id="locationError" class="error-message"></div>
                </div>
            </div>

            <!-- Why Answer Authentically Section -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">🎯</span>
                    <h2 class="section-title">Why Answer These Questions Authentically?</h2>
                </div>
                
                <div class="wisdom-card">
                    <div class="wisdom-header">
                        <span>⚖️</span>
                        <span>Your Answers Directly Impact Your Soul Age Calculation</span>
                    </div>
                    <p style="line-height: 1.8; color: #4B5563; margin-bottom: 15px;">
                        Each question can shift your calculated soul age by <strong>hundreds of incarnations</strong> because they measure your current <strong>level of consciousness</strong> - which in spiritual traditions matters more than chronological experience. Here's the deeper wisdom behind each question:
                    </p>
                </div>

                <div class="questions-explanation">
                    <div class="question-explanation-card">
                        <div class="question-title">🌟 "What drives you most in life?"</div>
                        <div class="spiritual-basis">
                            <strong>Vedantic Basis:</strong> Maps to the <em>Purusharthas</em> (four life goals):
                            <ul style="margin-top: 8px; padding-left: 20px; color: #6B7280;">
                                <li><strong>Survival/Security</strong> → Infant Soul: Basic <em>Artha</em> (material security)</li>
                                <li><strong>Pleasure/Achievement</strong> → Young Soul: <em>Kama</em> and advanced <em>Artha</em></li>
                                <li><strong>Relationships</strong> → Mature Soul: <em>Dharma</em> through emotional connection</li>
                                <li><strong>Spiritual Growth</strong> → Old Soul: <em>Moksha</em> (liberation) seeking</li>
                            </ul>
                        </div>
                    </div>

                    <div class="question-explanation-card">
                        <div class="question-title">⚔️ "How do you handle conflict?"</div>
                        <div class="spiritual-basis">
                            <strong>Theosophical Teaching:</strong> Helena Blavatsky taught soul evolution through handling opposition:
                            <ul style="margin-top: 8px; padding-left: 20px; color: #6B7280;">
                                <li><strong>Avoid/Fight</strong> → Infant/Baby Soul: Fear or tribal responses</li>
                                <li><strong>Compete strategically</strong> → Young Soul: Ego-driven power dynamics</li>
                                <li><strong>Understand perspectives</strong> → Mature Soul: Emotional intelligence</li>
                                <li><strong>Transcend entirely</strong> → Old Soul: Witness consciousness, non-attachment</li>
                            </ul>
                        </div>
                    </div>

                    <div class="question-explanation-card">
                        <div class="question-title">💰 "Relationship with material possessions?"</div>
                        <div class="spiritual-basis">
                            <strong>Bhagavad Gita Wisdom:</strong> Stages of detachment from materialism:
                            <ul style="margin-top: 8px; padding-left: 20px; color: #6B7280;">
                                <li><strong>Essential for security</strong> → Infant Soul: <em>Tamasic</em> attachment</li>
                                <li><strong>Success and status</strong> → Young Soul: Peak <em>Rajasic</em> materialism</li>
                                <li><strong>Tools for purpose</strong> → Mature/Old Soul: <em>Sattvic</em> relationship</li>
                                <li><strong>Feel like burden</strong> → Old Soul: Moving toward <em>Sannyasa</em> (renunciation)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="question-explanation-card">
                        <div class="question-title">📚 "How do you learn best?"</div>
                        <div class="spiritual-basis">
                            <strong>Theosophical Learning Evolution:</strong> Annie Besant's teachings on consciousness development:
                            <ul style="margin-top: 8px; padding-left: 20px; color: #6B7280;">
                                <li><strong>Repetition/Rules</strong> → Infant/Baby Soul: Concrete operational thinking</li>
                                <li><strong>Direct experience</strong> → Young Soul: Empirical learning</li>
                                <li><strong>Deep reflection</strong> → Mature Soul: Introspective wisdom</li>
                                <li><strong>Intuition/Insight</strong> → Old Soul: <em>Buddhic</em> plane access</li>
                            </ul>
                        </div>
                    </div>

                    <div class="question-explanation-card">
                        <div class="question-title">🔄 "Attitude toward change?"</div>
                        <div class="spiritual-basis">
                            <strong>Vedantic Understanding:</strong> Relationship with <em>Maya</em> (impermanence):
                            <ul style="margin-top: 8px; padding-left: 20px; color: #6B7280;">
                                <li><strong>Resist strongly</strong> → Infant/Baby Soul: Attachment to form</li>
                                <li><strong>Seek excitement</strong> → Young Soul: <em>Rajas</em> (stimulation-seeking)</li>
                                <li><strong>Growth opportunity</strong> → Mature Soul: Accepting <em>karma</em> as teacher</li>
                                <li><strong>Catalyze in others</strong> → Old Soul: <em>Bodhisattva</em> impulse</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="wisdom-card" style="margin-top: 25px;">
                    <div class="wisdom-header">
                        <span>🚀</span>
                        <span>Why Single Answers Create Dramatic Shifts</span>
                    </div>
                    <p style="line-height: 1.8; color: #4B5563;">
                        Each question can shift your result by <strong>400 incarnations</strong> because Theosophy teaches that <em>"a single shift in consciousness can represent lifetimes of evolution."</em> Someone might be chronologically a Young Soul (incarnation 350) but demonstrate Old Soul wisdom about materialism, adjusting their functional soul age to 650+.
                    </p>
                    <p style="margin-top: 15px; line-height: 1.8; color: #4B5563;">
                        <strong>Vedantic Truth:</strong> Your current level of awareness matters more than how many lives you've lived. Consciousness evolution isn't linear - it can accelerate rapidly through conscious choice and spiritual practice.
                    </p>
                </div>

                <div style="background: linear-gradient(135deg, #F59E0B, #D97706); color: white; padding: 20px; border-radius: 15px; text-align: center; margin-top: 20px;">
                    <div style="font-size: 1.1rem; font-weight: 600; margin-bottom: 10px;">
                        🙏 Answer with Complete Honesty
                    </div>
                    <div style="opacity: 0.95; line-height: 1.6;">
                        Your authentic responses reveal your soul's current evolutionary state. There are no "right" answers - only honest ones that lead to meaningful insights about your spiritual journey.
                    </div>
                </div>
            </div>

            <!-- Soul Insights Survey -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">🧿</span>
                    <h2 class="section-title">Soul Insights Survey</h2>
                </div>
                <p style="color: #6B7280; margin-bottom: 20px;">
                    These questions help refine your soul age calculation by understanding your current life patterns and spiritual inclinations.
                </p>

                <div class="survey-grid">
                    <div class="question-card">
                        <div class="question-text">What drives you most in life?</div>
                        <select id="q1">
                            <option value="">Select one...</option>
                            <option value="survival">Basic survival, security, and material needs</option>
                            <option value="pleasure">Pleasure, excitement, and new experiences</option>
                            <option value="success">Success, achievement, and recognition</option>
                            <option value="relationships">Deep relationships and emotional connections</option>
                            <option value="meaning">Meaning, wisdom, and spiritual growth</option>
                        </select>
                    </div>

                    <div class="question-card">
                        <div class="question-text">How do you typically handle conflict?</div>
                        <select id="q2">
                            <option value="">Select one...</option>
                            <option value="avoid">Avoid it at all costs</option>
                            <option value="fight">Fight aggressively to win</option>
                            <option value="compete">Compete strategically</option>
                            <option value="understand">Seek to understand all perspectives</option>
                            <option value="transcend">Find ways to transcend the conflict entirely</option>
                        </select>
                    </div>

                    <div class="question-card">
                        <div class="question-text">What's your relationship with material possessions?</div>
                        <select id="q3">
                            <option value="">Select one...</option>
                            <option value="essential">They're essential for my sense of security</option>
                            <option value="enjoy">I enjoy them but they're not everything</option>
                            <option value="status">They represent my success and status</option>
                            <option value="tools">They're just tools for deeper purposes</option>
                            <option value="burden">They often feel like a burden</option>
                        </select>
                    </div>

                    <div class="question-card">
                        <div class="question-text">How do you learn best?</div>
                        <select id="q4">
                            <option value="">Select one...</option>
                            <option value="repetition">Through repetition and following rules</option>
                            <option value="experience">Through direct, often intense experiences</option>
                            <option value="systems">Through structured systems and methods</option>
                            <option value="reflection">Through deep reflection and inner work</option>
                            <option value="intuition">Through intuition and spiritual insight</option>
                        </select>
                    </div>

                    <div class="question-card">
                        <div class="question-text">What's your attitude toward change?</div>
                        <select id="q5">
                            <option value="">Select one...</option>
                            <option value="resist">I strongly resist most changes</option>
                            <option value="excitement">I seek change for excitement</option>
                            <option value="opportunity">I see change as opportunity for growth</option>
                            <option value="natural">I accept change as natural and necessary</option>
                            <option value="catalyst">I often catalyze change in others</option>
                        </select>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin: 30px 0;">
                <button class="calculate-btn" onclick="calculateSoulAge()" disabled>
                    ✨ Calculate My Soul Age ✨
                </button>
            </div>
            
            <!-- Results Section -->
            <div id="results" class="results-container">
                <div class="soul-age-display">
                    <div class="confidence-indicator">
                        <span id="confidenceDot" class="confidence-dot"></span>
                        <span id="confidenceText" class="confidence-text"></span>
                    </div>
                    
                    <div class="soul-age-number" id="soulAgeNumber">~</div>
                    <div class="soul-stage" id="soulStage">Calculating...</div>
                    <div class="soul-stage-description" id="soulStageDescription"></div>

                    <div class="incarnation-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="incarnationRange">-</div>
                            <div class="stat-label">Incarnation Range</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="earthYears">-</div>
                            <div class="stat-label">Earth Years</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="spiralLevel">-</div>
                            <div class="stat-label">Evolutionary Spiral</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="remainingLives">-</div>
                            <div class="stat-label">Remaining Lives</div>
                        </div>
                    </div>
                </div>

                <!-- Detailed Stage Description -->
                <div id="stageDescriptionCard" class="stage-description-card">
                    <div class="stage-description-title" id="stageDescriptionTitle"></div>
                    <div class="stage-description-text" id="stageDescriptionText"></div>
                    <div class="stage-traits" id="stageTraits"></div>
                </div>

                <!-- Characteristics Section -->
                <div class="section">
                    <div class="section-header">
                        <span class="section-icon">🎯</span>
                        <h2 class="section-title">Your Soul Characteristics</h2>
                    </div>
                    <div id="characteristicsDisplay">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 2: Understanding -->
        <div id="understanding-tab" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">🕉️</span>
                    <h2 class="section-title">The 777-Incarnation Framework</h2>
                </div>

                <div class="wisdom-card">
                    <div class="wisdom-header">
                        <span>📜</span>
                        <span>What This Calculator Does</span>
                    </div>
                    <p style="line-height: 1.8; color: #4B5563;">
                        This calculator determines where you are in your soul's 777-lifetime journey on Earth. Based on ancient spiritual teachings from India (Vedanta) and 19th-century Theosophical wisdom, it calculates your approximate "soul age" - how many lifetimes you've experienced as a human being.
                    </p>
                    <p style="margin-top: 15px; line-height: 1.8; color: #4B5563;">
                        Think of it like determining what grade you're in at "Earth School." Just as students progress through elementary, middle school, high school, and college, souls progress through different stages of human development across many lifetimes.
                    </p>
                </div>

                <div class="wisdom-card">
                    <div class="wisdom-header">
                        <span>🌟</span>
                        <span>The Five Soul Ages Explained Simply</span>
                    </div>
                    <p style="line-height: 1.8; color: #4B5563; margin-bottom: 20px;">
                        Every human soul progresses through five main stages during their Earth incarnations. Each stage has its own lessons, challenges, and ways of seeing the world:
                    </p>

                    <div class="evolution-stages">
                        <div class="stage-card infant">
                            <div class="stage-number">Stage 1</div>
                            <div class="stage-name">Infant Soul (Lives 1-155)</div>
                            <div class="stage-range">The "Kindergarten" of Human Experience</div>
                            <div class="stage-description-text">
                                <strong>What they're learning:</strong> Basic human survival, how bodies work, basic social rules.
                                <br><strong>Like:</strong> A child learning to walk and talk - everything is new and overwhelming.
                                <br><strong>Focus:</strong> Safety, following rules, staying alive, simple pleasures.
                                <br><strong>Challenges:</strong> Fear of the unknown, need for security, difficulty with complexity.
                                <br><strong>Common Traits:</strong> Simple lifestyle preferences, traditional values, literal thinking, strong tribal/group loyalties, fear of change, focus on basic needs and comforts.
                            </div>
                        </div>

                        <div class="stage-card baby">
                            <div class="stage-number">Stage 2</div>
                            <div class="stage-name">Baby Soul (Lives 156-310)</div>
                            <div class="stage-range">The "Elementary School" Phase</div>
                            <div class="stage-description-text">
                                <strong>What they're learning:</strong> Right vs. wrong, group belonging, tradition, authority.
                                <br><strong>Like:</strong> A child who wants clear rules and gets upset when others break them.
                                <br><strong>Focus:</strong> Order, tradition, belonging to groups, moral certainty.
                                <br><strong>Challenges:</strong> Judging others, rigidity, fear of being different.
                                <br><strong>Common Traits:</strong> Strong moral convictions, traditional religious or political beliefs, difficulty accepting different lifestyles, focus on duty and conformity, black-and-white thinking.
                            </div>
                        </div>

                        <div class="stage-card young">
                            <div class="stage-number">Stage 3</div>
                            <div class="stage-name">Young Soul (Lives 311-465)</div>
                            <div class="stage-range">The "High School" Experience</div>
                            <div class="stage-description-text">
                                <strong>What they're learning:</strong> Personal power, achievement, independence, success.
                                <br><strong>Like:</strong> A teenager wanting to prove themselves and make their mark on the world.
                                <br><strong>Focus:</strong> Success, recognition, building things, competition, material achievement.
                                <br><strong>Challenges:</strong> Ego, workaholism, sacrificing relationships for success.
                                <br><strong>Common Traits:</strong> Highly ambitious, competitive, materialistic, excellent at building careers/businesses, impatient with "inefficiency," often wealthy or power-seeking.
                            </div>
                        </div>

                        <div class="stage-card mature">
                            <div class="stage-number">Stage 4</div>
                            <div class="stage-name">Mature Soul (Lives 466-620)</div>
                            <div class="stage-range">The "College Years" of Soul Development</div>
                            <div class="stage-description-text">
                                <strong>What they're learning:</strong> Emotional depth, authentic relationships, inner truth, psychology.
                                <br><strong>Like:</strong> A college student questioning everything they were taught and seeking deeper meaning.
                                <br><strong>Focus:</strong> Relationships, emotions, authenticity, personal growth, therapy.
                                <br><strong>Challenges:</strong> Emotional intensity, relationship drama, existential angst.
                                <br><strong>Common Traits:</strong> Emotionally intense, drawn to therapy/psychology, questions authority, values authenticity over success, relationship-focused, often in helping professions.
                            </div>
                        </div>

                        <div class="stage-card old">
                            <div class="stage-number">Stage 5</div>
                            <div class="stage-name">Old Soul (Lives 621-777)</div>
                            <div class="stage-range">The "Graduate School" of Human Experience</div>
                            <div class="stage-description-text">
                                <strong>What they're learning:</strong> Wisdom, detachment, service, spiritual truth, universal love.
                                <br><strong>Like:</strong> A wise professor who's "been there, done that" and now wants to help others.
                                <br><strong>Focus:</strong> Wisdom, teaching, service, spirituality, simplicity, peace.
                                <br><strong>Challenges:</strong> Feeling disconnected from materialism, difficulty fitting into society.
                                <br><strong>Common Traits:</strong> Spiritually oriented, comfortable with solitude, often in teaching/healing roles, simple lifestyle, wise beyond their years, sometimes feel like they don't belong.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="wisdom-card">
                    <div class="wisdom-header">
                        <span>🔄</span>
                        <span>Why 777 Lives?</span>
                    </div>
                    <p style="line-height: 1.8; color: #4B5563;">
                        The number 777 comes from ancient spiritual mathematics. In many traditions, 7 represents completion and perfection. The triple 7 (777) represents the complete journey of human soul evolution. It's calculated as 7 major cycles × 111 incarnations each = 777 total human lives needed to learn everything Earth has to teach us.
                    </p>
                </div>

                <div class="wisdom-card">
                    <div class="wisdom-header">
                        <span>⚖️</span>
                        <span>Important Disclaimers</span>
                    </div>
                    <p style="line-height: 1.8; color: #4B5563;">
                        <strong>This is for Entertainment & Self-Reflection:</strong> This calculator is based on spiritual theories, not scientific facts. Use it as a tool for self-understanding and personal growth, not as absolute truth about your soul or destiny.
                    </p>
                    <p style="margin-top: 15px; line-height: 1.8; color: #4B5563;">
                        <strong>Every Soul is Unique:</strong> Even souls at the same "age" can be very different. Your individual life experiences, choices, and karma create your unique path.
                    </p>
                </div>
            </div>
        </div>

        <!-- Tab 3: Jaimini Analysis -->
        <div id="jaimini-tab" class="tab-content">
            <!-- Introduction Section -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">🔮</span>
                    <h2 class="section-title">Jaimini (Jamakkol) Astrological Analysis</h2>
                </div>

                <div class="wisdom-card">
                    <div class="wisdom-header">
                        <span>📜</span>
                        <span>What is Jaimini/Jamakkol Astrology? (For Complete Beginners)</span>
                    </div>
                    <p style="line-height: 1.8; color: #4B5563; margin-bottom: 15px;">
                        <strong>Jaimini astrology</strong> (also called <strong>Jamakkol</strong> in some traditions) is like having a spiritual GPS for your soul's journey. Imagine you're on a road trip, but instead of going from city to city, your soul is traveling from lifetime to lifetime, learning different lessons along the way.
                    </p>
                    <p style="line-height: 1.8; color: #4B5563; margin-bottom: 15px;">
                        <strong>Regular astrology</strong> might tell you "You'll be good with money" or "You'll face challenges in relationships." <strong>Jaimini astrology</strong> asks deeper questions like "Why did your soul choose to learn about money in this lifetime?" or "What spiritual growth comes from your relationship challenges?"
                    </p>
                    <p style="line-height: 1.8; color: #4B5563;">
                        Think of it this way: If regular astrology looks at the weather on the surface of a lake, Jaimini astrology dives deep to understand the currents, the fish, and the entire ecosystem beneath the water.
                    </p>
                </div>

                <div class="wisdom-card">
                    <div class="wisdom-header">
                        <span>🎯</span>
                        <span>Key Jaimini Terms Explained Simply</span>
                    </div>
                    <div style="display: grid; gap: 15px; margin-top: 15px;">
                        <div style="background: #F9FAFB; padding: 15px; border-radius: 10px; border-left: 4px solid var(--sacred-gold);">
                            <h4 style="color: var(--sacred-gold); font-weight: 700; margin-bottom: 8px;">Atmakaraka - "Your Soul's Main Teacher"</h4>
                            <p style="color: #6B7280; line-height: 1.6;">This is the planet that represents your soul's primary lesson in this lifetime. Think of it as your soul's "major" in the university of life. If your Atmakaraka is Mars, your soul came to learn courage. If it's Venus, you're learning about love and beauty.</p>
                        </div>
                        <div style="background: #F9FAFB; padding: 15px; border-radius: 10px; border-left: 4px solid var(--secondary);">
                            <h4 style="color: var(--secondary); font-weight: 700; margin-bottom: 8px;">Arudha Lagna - "Your Soul's Disguise"</h4>
                            <p style="color: #6B7280; line-height: 1.6;">This shows how others see you versus who you really are inside. It's like the difference between your Facebook profile and your private diary. The bigger the difference, the more your soul is working on authenticity.</p>
                        </div>
                        <div style="background: #F9FAFB; padding: 15px; border-radius: 10px; border-left: 4px solid var(--primary);">
                            <h4 style="color: var(--primary); font-weight: 700; margin-bottom: 8px;">Karmic Theme - "Your Life's Main Subject"</h4>
                            <p style="color: #6B7280; line-height: 1.6;">This is the overarching theme of what your soul is studying in this lifetime. Like choosing between studying science, art, business, or spirituality - but for your soul's evolution.</p>
                        </div>
                        <div style="background: #F9FAFB; padding: 15px; border-radius: 10px; border-left: 4px solid var(--success);">
                            <h4 style="color: var(--success); font-weight: 700; margin-bottom: 8px;">Soul Lesson - "Your Graduation Requirement"</h4>
                            <p style="color: #6B7280; line-height: 1.6;">This is the specific skill or wisdom your soul needs to master before it can "graduate" to the next level. Think of it as your spiritual thesis project.</p>
                        </div>
                    </div>
                </div>

                <div class="wisdom-card">
                    <div class="wisdom-header">
                        <span>🔍</span>
                        <span>Why Jaimini is Different from Other Astrology</span>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                        <div>
                            <h4 style="color: var(--error); font-weight: 700; margin-bottom: 10px;">Regular Astrology Asks:</h4>
                            <ul style="color: #6B7280; line-height: 1.6; padding-left: 20px;">
                                <li>Will I be successful?</li>
                                <li>When will I get married?</li>
                                <li>What career is best for me?</li>
                                <li>Will I have money problems?</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="color: var(--success); font-weight: 700; margin-bottom: 10px;">Jaimini Astrology Asks:</h4>
                            <ul style="color: #6B7280; line-height: 1.6; padding-left: 20px;">
                                <li>Why did my soul choose this path?</li>
                                <li>What am I meant to learn from relationships?</li>
                                <li>How does my work serve my spiritual growth?</li>
                                <li>What karmic patterns am I healing?</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calculate Button Section -->
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">✨</span>
                    <h2 class="section-title">Calculate Your Jaimini Chart</h2>
                </div>
                <p style="color: #6B7280; margin-bottom: 25px; text-align: center;">
                    Your birth information has been entered in the Calculator tab. Click below to generate your personalized Jaimini analysis and spiritual guidance.
                </p>
                <div style="text-align: center;">
                    <button class="calculate-btn" onclick="calculateJaiminiChart()" disabled style="background: linear-gradient(135deg, #D97706 0%, #F59E0B 100%);">
                        🔮 Calculate My Jaimini Chart 🔮
                    </button>
                </div>
            </div>

            <!-- Jaimini Chart Results Section -->
            <div id="jaimini-results" class="results-container">
                <div class="soul-age-display" style="background: linear-gradient(135deg, #D97706 0%, #F59E0B 100%);">
                    <div class="soul-age-number" style="font-size: 2.5rem;">🔮 Your Jaimini Chart</div>
                    <div class="soul-stage" id="jaiminiTitle">Your Karmic Blueprint</div>
                    <div class="soul-stage-description" id="jaiminiDescription"></div>

                    <div class="incarnation-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="atmakaraka">-</div>
                            <div class="stat-label">Atmakaraka Planet</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="arudhaLagna">-</div>
                            <div class="stat-label">Arudha Lagna</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="karmicTheme">-</div>
                            <div class="stat-label">Karmic Theme</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="soulLesson">-</div>
                            <div class="stat-label">Primary Soul Lesson</div>
                        </div>
                    </div>
                </div>

                <!-- Jaimini Analysis Cards -->
                <div id="jaiminiAnalysis" class="section">
                    <div class="section-header">
                        <span class="section-icon">⭐</span>
                        <h2 class="section-title">Your Jaimini Analysis</h2>
                    </div>
                    <div id="jaiminiCards">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Personalized Spiritual Guidance Section -->
                <div id="spiritualGuidance" class="section">
                    <div class="section-header">
                        <span class="section-icon">🙏</span>
                        <h2 class="section-title">Your Personalized Spiritual Guidance</h2>
                    </div>
                    
                    <!-- General Spiritual Guidance -->
                    <div id="generalGuidance" class="wisdom-card">
                        <div class="wisdom-header">
                            <span>🌟</span>
                            <span>Universal Spiritual Practices for Your Path</span>
                        </div>
                        <div id="generalGuidanceContent">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Hindu/Vedantic Guidance -->
                    <div id="vedicGuidance" class="wisdom-card">
                        <div class="wisdom-header">
                            <span>🕉️</span>
                            <span>Vedantic & Hindu Practices for Your Atmakaraka</span>
                        </div>
                        <div id="vedicGuidanceContent">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Daily & Weekly Practices -->
                    <div id="dailyPractices" class="wisdom-card">
                        <div class="wisdom-header">
                            <span>📅</span>
                            <span>Daily & Weekly Spiritual Practices</span>
                        </div>
                        <div id="dailyPracticesContent">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Life Path & Karmic Guidance -->
                    <div id="karmicGuidance" class="wisdom-card">
                        <div class="wisdom-header">
                            <span>🛤️</span>
                            <span>Life Path & Karmic Lessons</span>
                        </div>
                        <div id="karmicGuidanceContent">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Meditation & Mindfulness -->
                    <div id="meditationGuidance" class="wisdom-card">
                        <div class="wisdom-header">
                            <span>🧘</span>
                            <span>Personalized Meditation & Mindfulness</span>
                        </div>
                        <div id="meditationGuidanceContent">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Relationships & Career Guidance -->
                    <div id="lifeGuidance" class="wisdom-card">
                        <div class="wisdom-header">
                            <span>💼</span>
                            <span>Spiritual Approach to Relationships & Career</span>
                        </div>
                        <div id="lifeGuidanceContent">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 4: FAQ -->
        <div id="faq-tab" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <span class="section-icon">❓</span>
                    <h2 class="section-title">Frequently Asked Questions</h2>
                </div>
                <p style="color: #6B7280; margin-bottom: 30px;">
                    Here are the most common questions people ask about soul age and this calculator. Click any question to see the answer.
                </p>

                <div class="faq-section">
                    <!-- Basic Concepts -->
                    <div class="faq-category">
                        <h3 class="faq-category-title">
                            <span>🌟</span>
                            Basic Concepts
                        </h3>
                        
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                What exactly is a "soul age"?
                                <span class="faq-toggle">▼</span>
                            </div>
                            <div class="faq-answer">
                                Soul age refers to how many lifetimes your soul has experienced as a human being on Earth. It's like asking "what grade are you in?" at the school of human experience. A newer soul might be in "kindergarten" while an older soul might be in "graduate school."
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                Do I really have a soul, and does it actually reincarnate?
                                <span class="faq-toggle">▼</span>
                            </div>
                            <div class="faq-answer">
                                This calculator is based on spiritual beliefs about reincarnation, not scientific facts. Many religions and spiritual traditions believe in souls and multiple lifetimes, while others don't. Use this as a tool for self-reflection rather than absolute truth. What matters is whether the insights help you understand yourself better.
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                Why 777 lives specifically? Where does this number come from?
                                <span class="faq-toggle">▼</span>
                            </div>
                            <div class="faq-answer">
                                The number 777 comes from ancient spiritual mathematics found in Hindu and Theosophical teachings. It represents 7 major evolutionary cycles × 111 incarnations each. Seven is considered a number of completion in many traditions, so triple 7 represents the complete human journey.
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                Is being an "older soul" better than being a "younger soul"?
                                <span class="faq-toggle">▼</span>
                            </div>
                            <div class="faq-answer">
                                No! Each soul age has its own gifts and purposes. Young souls bring energy, ambition, and drive to build the world. Mature souls bring emotional depth and healing. Old souls bring wisdom and spiritual insight. We need all ages working together. It's not about being "better" - it's about being at different stages of learning.
                            </div>
                        </div>
                    </div>

                    <!-- How the Calculator Works -->
                    <div class="faq-category">
                        <h3 class="faq-category-title">
                            <span>🧮</span>
                            How the Calculator Works
                        </h3>

                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                How does this calculator actually determine my soul age?
                                <span class="faq-toggle">▼</span>
                            </div>
                            <div class="faq-answer">
                                The calculator uses your birth information to create an astrological chart, then applies Jaimini astrology principles to analyze your soul patterns. It combines this with your survey responses about your life approach and values. It's like a spiritual algorithm that looks at multiple factors to estimate where you are in your soul's journey.
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                What if I don't know my exact birth time?
                                <span class="faq-toggle">▼</span>
                            </div>
                            <div class="faq-answer">
                                That's totally fine! The calculator automatically uses noon (12:00 PM) as a default if you don't provide a time or click "Don't Know Time - Use Noon." While the exact time can add precision, the date and location are more important for determining soul age. Many people don't know their exact birth time, and the calculator still provides valuable insights.
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                How accurate is this calculator?
                                <span class="faq-toggle">▼</span>
                            </div>
                            <div class="faq-answer">
                                The calculator provides estimates based on spiritual theories, not scientific measurements. Think of it like a personality test - it can offer insights and food for thought, but it's not a precise scientific instrument. Use the results as a starting point for self-reflection rather than absolute truth.
                            </div>
                        </div>
                    </div>

                    <!-- Understanding Your Results -->
                    <div class="faq-category">
                        <h3 class="faq-category-title">
                            <span>📊</span>
                            Understanding Your Results
                        </h3>

                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                My result doesn't feel right to me. What does that mean?
                                <span class="faq-toggle">▼</span>
                            </div>
                            <div class="faq-answer">
                                Trust your intuition! This calculator provides estimates based on limited information. You might be transitioning between soul ages, have unusual karmic patterns, or the system might not capture your unique situation. Use the result as one perspective among many, not as the final word on who you are.
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                What does "confidence level" mean in my results?
                                <span class="faq-toggle">▼</span>
                            </div>
                            <div class="faq-answer">
                                The confidence level shows how certain the calculator is about your result based on how clear your chart patterns are. High confidence means your chart shows strong, consistent patterns. Lower confidence might mean you're between soul ages or have complex patterns that are harder to categorize.
                            </div>
                        </div>
                    </div>

                    <!-- Technical & Spiritual -->
                    <div class="faq-category">
                        <h3 class="faq-category-title">
                            <span>🔮</span>
                            Technical & Spiritual Questions
                        </h3>

                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                Is this calculator storing my personal information?
                                <span class="faq-toggle">▼</span>
                            </div>
                            <div class="faq-answer">
                                No, this calculator doesn't store any of your personal information. Everything is calculated in your browser and nothing is saved to any database. Your privacy is completely protected. This is clearly stated as "No Data Stored" in our privacy notice.
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                What spiritual traditions is this based on?
                                <span class="faq-toggle">▼</span>
                            </div>
                            <div class="faq-answer">
                                This calculator combines concepts from Hindu Vedanta (especially the concept of Samsara - the cycle of birth and death), 19th-century Theosophy (Helena Blavatsky's teachings about soul evolution), and Jaimini astrology (an ancient Vedic astrological system). It synthesizes these traditions into a practical framework for understanding soul development.
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                Does this conflict with my religious beliefs?
                                <span class="faq-toggle">▼</span>
                            </div>
                            <div class="faq-answer">
                                This calculator is based on Eastern spiritual concepts that may or may not align with your religious beliefs. Many religions have different views on souls, afterlife, and reincarnation. Use this tool only if it feels helpful and doesn't conflict with your personal faith. It's meant for self-reflection, not to challenge your religious beliefs.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentLocationData = null;
        let searchTimeout = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            validateForm();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Date validation
            document.getElementById('birthDate').addEventListener('change', validateForm);
            
            // Time validation
            ['birthHour', 'birthMinute', 'ampm'].forEach(id => {
                const el = document.getElementById(id);
                el.addEventListener('change', () => {
                    validateTime();
                    validateForm();
                });
            });
            
            // Location validation
            document.getElementById('birthLocation').addEventListener('input', () => {
                validateLocation();
                validateForm();
            });

            // Survey validation
            ['q1', 'q2', 'q3', 'q4', 'q5'].forEach(id => {
                document.getElementById(id).addEventListener('change', validateForm);
            });
        }

        // Tab switching
        function switchTab(tabId, buttonEl) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab and activate button
            document.getElementById(tabId).classList.add('active');
            buttonEl.classList.add('active');
        }

        // Validation Functions
        function validateDate() {
            const input = document.getElementById('birthDate');
            const date = new Date(input.value);
            const now = new Date();
            const minDate = new Date(now.getFullYear() - 150, 0, 1);
            
            if (!input.value) {
                showError('dateError', 'Birth date is required');
                showValidation('dateValidation', false);
                return false;
            }
            
            if (date > now) {
                showError('dateError', 'Birth date cannot be in the future');
                showValidation('dateValidation', false);
                return false;
            }
            
            if (date < minDate) {
                showError('dateError', 'Birth date seems too far in the past');
                showValidation('dateValidation', false);
                return false;
            }
            
            hideError('dateError');
            showValidation('dateValidation', true);
            return true;
        }

        function validateTime() {
            const hour = document.getElementById('birthHour').value;
            const minute = document.getElementById('birthMinute').value || '0';
            const ampm = document.getElementById('ampm').value;
            
            // Time is completely optional - if hour and AM/PM are both empty, that's okay
            if (!hour && !ampm) {
                showValidation('timeValidation', true);
                hideError('timeError');
                return true;
            }
            
            // If hour is filled, AM/PM must also be filled
            if (hour && !ampm) {
                showError('timeError', 'Please select AM or PM, or click "Don\'t Know Time"');
                showValidation('timeValidation', false);
                return false;
            }
            
            // If AM/PM is filled, hour must also be filled
            if (!hour && ampm) {
                showError('timeError', 'Please select an hour, or click "Don\'t Know Time"');
                showValidation('timeValidation', false);
                return false;
            }
            
            // If both hour and AM/PM are filled, validate the values
            if (hour && ampm) {
                const hourNum = parseInt(hour);
                const minuteNum = parseInt(minute);
                
                if (hourNum < 1 || hourNum > 12) {
                    showError('timeError', 'Hour must be between 1 and 12');
                    showValidation('timeValidation', false);
                    return false;
                }
                
                if (minuteNum < 0 || minuteNum > 59) {
                    showError('timeError', 'Minutes must be between 0 and 59');
                    showValidation('timeValidation', false);
                    return false;
                }
            }
            
            hideError('timeError');
            showValidation('timeValidation', true);
            return true;
        }

        function validateLocation() {
            const input = document.getElementById('birthLocation');
            
            if (!input.value.trim()) {
                showError('locationError', 'Birth location is required');
                showValidation('locationValidation', false);
                return false;
            }
            
            if (!currentLocationData) {
                showError('locationError', 'Please select a location from the dropdown');
                showValidation('locationValidation', false);
                return false;
            }
            
            hideError('locationError');
            showValidation('locationValidation', true);
            return true;
        }

        function validateForm() {
            const dateValid = validateDate();
            const timeValid = validateTime();
            const locationValid = validateLocation();
            
            // Check survey questions
            const surveyValid = ['q1', 'q2', 'q3', 'q4', 'q5'].every(id => 
                document.getElementById(id).value !== ''
            );
            
            const basicInfoValid = dateValid && timeValid && locationValid;
            const allValid = basicInfoValid && surveyValid;
            
            // Enable/disable buttons based on requirements
            const soulAgeBtn = document.querySelector('button[onclick="calculateSoulAge()"]');
            const jaiminiBtn = document.querySelector('button[onclick="calculateJaiminiChart()"]');
            
            if (soulAgeBtn) soulAgeBtn.disabled = !allValid;
            if (jaiminiBtn) jaiminiBtn.disabled = !basicInfoValid; // Jaimini only needs basic info
            
            return allValid;
        }

        function showError(errorId, message) {
            const errorEl = document.getElementById(errorId);
            errorEl.textContent = message;
            errorEl.classList.add('show');
        }

        function hideError(errorId) {
            const errorEl = document.getElementById(errorId);
            errorEl.classList.remove('show');
        }

        function showValidation(validationId, isValid) {
            const validationEl = document.getElementById(validationId);
            validationEl.className = `validation-icon ${isValid ? 'valid' : 'invalid'}`;
            validationEl.textContent = isValid ? '✓' : '✗';
        }

        // Location search functionality
        function searchLocation() {
            const query = document.getElementById('birthLocation').value;
            
            if (query.length < 3) {
                hideLocationDropdown();
                return;
            }
            
            // Clear previous timeout
            if (searchTimeout) {
                clearTimeout(searchTimeout);
            }
            
            // Debounce the search
            searchTimeout = setTimeout(() => {
                performLocationSearch(query);
            }, 300);
        }

        async function performLocationSearch(query) {
            const dropdown = document.getElementById('locationAutocomplete');
            
            try {
                showLocationStatus('Searching...');
                
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/search?format=json&limit=5&q=${encodeURIComponent(query)}`
                );
                
                const locations = await response.json();
                
                if (locations.length === 0) {
                    showLocationStatus('No locations found');
                    return;
                }
                
                displayLocationResults(locations);
                
            } catch (error) {
                console.error('Location search error:', error);
                showLocationStatus('Search unavailable');
            }
        }

        function displayLocationResults(locations) {
            const dropdown = document.getElementById('locationAutocomplete');
            
            dropdown.innerHTML = locations.map(location => `
                <div class="autocomplete-item" onclick="selectLocation('${location.display_name}', ${location.lat}, ${location.lon})">
                    <div class="location-name">${location.display_name.split(',')[0]}</div>
                    <div class="location-details">${location.display_name}</div>
                </div>
            `).join('');
            
            dropdown.style.display = 'block';
        }

        function selectLocation(name, lat, lon) {
            document.getElementById('birthLocation').value = name;
            currentLocationData = { name, lat, lon };
            hideLocationDropdown();
            validateLocation();
            validateForm();
        }

        function showLocationStatus(message) {
            const dropdown = document.getElementById('locationAutocomplete');
            dropdown.innerHTML = `<div class="search-status loading">${message}</div>`;
            dropdown.style.display = 'block';
        }

        function hideLocationDropdown() {
            document.getElementById('locationAutocomplete').style.display = 'none';
        }

        // Unknown time functionality
        function useUnknownTime() {
            document.getElementById('birthHour').value = '12';
            document.getElementById('birthMinute').value = '0';
            document.getElementById('ampm').value = 'PM';
            validateTime();
            validateForm();
        }

        // Soul Age Calculation
        async function calculateSoulAge() {
            const button = document.querySelector('.calculate-btn');
            button.disabled = true;
            button.textContent = '🔮 Calculating Your Soul Age...';
            
            // Simulate calculation time
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            try {
                const results = performSoulAgeCalculation();
                displayResults(results);
                
                // Scroll to results
                document.getElementById('results').scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
                
            } catch (error) {
                console.error('Calculation error:', error);
                alert('Sorry, there was an error calculating your soul age. Please try again.');
            } finally {
                button.disabled = false;
                button.textContent = '✨ Calculate My Soul Age ✨';
            }
        }

        function performSoulAgeCalculation() {
            // Get form data
            const birthDate = new Date(document.getElementById('birthDate').value);
            const birthHour = document.getElementById('birthHour').value || '12';
            const birthMinute = document.getElementById('birthMinute').value || '0';
            const ampm = document.getElementById('ampm').value || 'PM';
            
            // Convert to 24-hour time (defaulting to noon if not specified)
            let hour24 = parseInt(birthHour);
            if (ampm === 'PM' && hour24 !== 12) hour24 += 12;
            if (ampm === 'AM' && hour24 === 12) hour24 = 0;
            
            const birthTime = new Date(birthDate.getFullYear(), birthDate.getMonth(), birthDate.getDate(), hour24, parseInt(birthMinute));
            
            // Calculate astrological factors
            const astroFactors = calculateAstrologicalFactors(birthTime, currentLocationData);
            
            // Get survey responses
            const surveyResponses = getSurveyResponses();
            
            // Calculate soul age
            const soulAge = calculateBaseSoulAge(astroFactors, surveyResponses);
            
            // Determine stage and characteristics
            const stage = determineSoulStage(soulAge);
            const characteristics = getSoulCharacteristics(stage, soulAge);
            
            return {
                soulAge: Math.round(soulAge),
                stage: stage.name,
                stageDescription: stage.description,
                range: stage.range,
                earthYears: soulAge * 65, // Average human lifespan
                spiralLevel: Math.ceil(soulAge / 111),
                remainingLives: Math.max(0, 777 - Math.round(soulAge)),
                confidence: calculateConfidence(astroFactors, surveyResponses),
                characteristics: characteristics
            };
        }

        function calculateAstrologicalFactors(birthTime, location) {
            // Simplified astrological calculation based on birth date and time
            const dayOfYear = Math.floor((birthTime - new Date(birthTime.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24));
            const hourOfDay = birthTime.getHours() + birthTime.getMinutes() / 60;
            
            // Mock Jaimini calculations
            const atmakaraka = (dayOfYear * 7 + hourOfDay) % 9; // 0-8 representing planets
            const arudhaLagna = (dayOfYear + hourOfDay * 15) % 12; // 0-11 representing houses
            const charaKarakas = Array.from({length: 7}, (_, i) => (atmakaraka + i) % 9);
            
            return {
                atmakaraka,
                arudhaLagna,
                charaKarakas,
                dayOfYear,
                hourOfDay
            };
        }

        function getSurveyResponses() {
            return {
                q1: document.getElementById('q1').value,
                q2: document.getElementById('q2').value,
                q3: document.getElementById('q3').value,
                q4: document.getElementById('q4').value,
                q5: document.getElementById('q5').value
            };
        }

        function calculateBaseSoulAge(astroFactors, surveyResponses) {
            // Base calculation from astrological factors
            let baseAge = astroFactors.dayOfYear + (astroFactors.hourOfDay * 10);
            baseAge += (astroFactors.atmakaraka * 50);
            baseAge += (astroFactors.arudhaLagna * 30);
            
            // Adjust based on survey responses
            const surveyAdjustment = calculateSurveyAdjustment(surveyResponses);
            baseAge += surveyAdjustment;
            
            // Normalize to 1-777 range
            return Math.min(777, Math.max(1, baseAge % 777));
        }

        function calculateSurveyAdjustment(responses) {
            let adjustment = 0;
            
            // Question 1: Life drive
            const q1Map = { 'survival': -100, 'pleasure': -50, 'success': 0, 'relationships': 100, 'meaning': 200 };
            adjustment += q1Map[responses.q1] || 0;
            
            // Question 2: Conflict handling
            const q2Map = { 'avoid': -100, 'fight': -50, 'compete': 0, 'understand': 100, 'transcend': 200 };
            adjustment += q2Map[responses.q2] || 0;
            
            // Question 3: Material possessions
            const q3Map = { 'essential': -100, 'enjoy': -50, 'status': 0, 'tools': 100, 'burden': 200 };
            adjustment += q3Map[responses.q3] || 0;
            
            // Question 4: Learning style
            const q4Map = { 'repetition': -100, 'experience': -50, 'systems': 0, 'reflection': 100, 'intuition': 200 };
            adjustment += q4Map[responses.q4] || 0;
            
            // Question 5: Attitude toward change
            const q5Map = { 'resist': -100, 'excitement': -50, 'opportunity': 0, 'natural': 100, 'catalyst': 200 };
            adjustment += q5Map[responses.q5] || 0;
            
            return adjustment;
        }

        function determineSoulStage(soulAge) {
            if (soulAge <= 155) {
                return {
                    name: 'Infant Soul',
                    description: 'You are in the early stages of human experience, learning basic survival and how to exist in a physical body.',
                    range: [1, 155]
                };
            } else if (soulAge <= 310) {
                return {
                    name: 'Baby Soul',
                    description: 'You are learning structure, rules, and how to belong to groups and communities.',
                    range: [156, 310]
                };
            } else if (soulAge <= 465) {
                return {
                    name: 'Young Soul',
                    description: 'You are focused on achievement, success, and making your mark in the world.',
                    range: [311, 465]
                };
            } else if (soulAge <= 620) {
                return {
                    name: 'Mature Soul',
                    description: 'You are exploring emotional depth, relationships, and authentic self-expression.',
                    range: [466, 620]
                };
            } else {
                return {
                    name: 'Old Soul',
                    description: 'You are seeking wisdom, spiritual truth, and ways to serve humanity\'s evolution.',
                    range: [621, 777]
                };
            }
        }

        function calculateConfidence(astroFactors, surveyResponses) {
            // Simple confidence calculation based on consistency of indicators
            let score = 0;
            
            // Check if astrological and survey indicators align
            const expectedSurveyStage = Math.floor((astroFactors.dayOfYear + astroFactors.atmakaraka * 50) / 155);
            const surveyAdjustment = calculateSurveyAdjustment(surveyResponses);
            const surveyStage = Math.floor((surveyAdjustment + 500) / 200);
            
            if (Math.abs(expectedSurveyStage - surveyStage) <= 1) score += 50;
            if (astroFactors.atmakaraka > 6) score += 25; // Higher planets indicate more experience
            if (currentLocationData) score += 25; // Having location data increases confidence
            
            if (score >= 75) return 'high';
            if (score >= 50) return 'medium';
            return 'low';
        }

        function getSoulCharacteristics(stage, soulAge) {
            const characteristics = {
                strengths: [],
                challenges: [],
                focus: [],
                practices: []
            };
            
            if (stage.name === 'Infant Soul') {
                characteristics.strengths = [
                    "Natural innocence and wonder",
                    "Strong survival instincts", 
                    "Ability to live in the present moment",
                    "Direct, uncomplicated approach to life"
                ];
                characteristics.challenges = [
                    "Fear of new experiences",
                    "Difficulty with complex emotions",
                    "Need for safety and routine",
                    "Limited perspective on life's bigger picture"
                ];
                characteristics.focus = [
                    "Basic survival and security",
                    "Learning to navigate physical world",
                    "Developing simple social skills",
                    "Building trust in others"
                ];
                characteristics.practices = [
                    "Grounding exercises and nature connection",
                    "Simple meditation and breathing",
                    "Gentle yoga and body awareness",
                    "Creating safe, nurturing environments"
                ];
            } else if (stage.name === 'Baby Soul') {
                characteristics.strengths = [
                    "Strong sense of right and wrong",
                    "Loyalty and commitment to groups",
                    "Appreciation for tradition and order",
                    "Reliable and responsible nature"
                ];
                characteristics.challenges = [
                    "Rigidity and resistance to change",
                    "Tendency to judge others harshly",
                    "Fear of stepping outside comfort zone",
                    "Difficulty accepting different viewpoints"
                ];
                characteristics.focus = [
                    "Building stable communities and families",
                    "Following moral and ethical guidelines",
                    "Preserving traditions and values",
                    "Creating order from chaos"
                ];
                characteristics.practices = [
                    "Group worship or spiritual community",
                    "Traditional meditation or prayer",
                    "Service work within established organizations",
                    "Study of moral and ethical teachings"
                ];
            } else if (stage.name === 'Young Soul') {
                characteristics.strengths = [
                    "High energy and ambition",
                    "Natural leadership abilities",
                    "Confidence and self-reliance",
                    "Ability to manifest goals"
                ];
                characteristics.challenges = [
                    "Ego-driven decision making",
                    "Difficulty with emotional depth",
                    "Tendency toward materialism",
                    "Impatience with others' limitations"
                ];
                characteristics.focus = [
                    "Achievement and worldly success",
                    "Building personal power and influence",
                    "Material accumulation and status",
                    "Individual recognition and fame"
                ];
                characteristics.practices = [
                    "Goal-setting and achievement practices",
                    "Competitive sports and challenges",
                    "Leadership development and networking",
                    "Success-oriented meditation and visualization"
                ];
            } else if (stage.name === 'Mature Soul') {
                characteristics.strengths = [
                    "Deep emotional intelligence",
                    "Capacity for intimate relationships",
                    "Authenticity and self-awareness",
                    "Natural counseling and healing abilities"
                ];
                characteristics.challenges = [
                    "Emotional intensity and drama",
                    "Difficulty with boundaries",
                    "Tendency toward co-dependency",
                    "Existential anxiety and questioning"
                ];
                characteristics.focus = [
                    "Deep personal relationships",
                    "Emotional healing and growth",
                    "Authentic self-expression",
                    "Psychological understanding"
                ];
                characteristics.practices = [
                    "Therapy and counseling work",
                    "Relationship and communication skills",
                    "Emotional healing modalities",
                    "Creative and artistic expression"
                ];
            } else { // Old Soul
                characteristics.strengths = [
                    "Natural wisdom and perspective",
                    "Compassion for all beings",
                    "Spiritual insight and intuition",
                    "Ability to see the bigger picture"
                ];
                characteristics.challenges = [
                    "Feeling disconnected from material world",
                    "Difficulty relating to younger souls",
                    "Tendency toward isolation",
                    "Impatience with society's pace"
                ];
                characteristics.focus = [
                    "Spiritual growth and enlightenment",
                    "Service to humanity",
                    "Teaching and sharing wisdom",
                    "Simple, meaningful living"
                ];
                characteristics.practices = [
                    "Meditation and contemplation",
                    "Service work and volunteering",
                    "Study of spiritual texts and teachings",
                    "Mentoring and teaching others"
                ];
            }
            
            return characteristics;
        }

        function displayResults(results) {
            // Update main display
            document.getElementById('soulAgeNumber').textContent = '~' + results.soulAge;
            document.getElementById('soulStage').textContent = results.stage;
            document.getElementById('soulStageDescription').textContent = results.stageDescription;
            document.getElementById('incarnationRange').textContent = 
                results.range[0] + '-' + results.range[1];
            document.getElementById('earthYears').textContent = 
                '~' + Math.round(results.earthYears / 1000) + 'k';
            document.getElementById('spiralLevel').textContent = 
                results.spiralLevel + getOrdinalSuffix(results.spiralLevel);
            document.getElementById('remainingLives').textContent = results.remainingLives;
            
            // Update confidence display
            const confidenceDot = document.getElementById('confidenceDot');
            const confidenceText = document.getElementById('confidenceText');
            confidenceDot.className = 'confidence-dot confidence-' + results.confidence;
            
            const confidenceLabels = {
                'high': 'High Confidence',
                'medium': 'Medium Confidence', 
                'low': 'Low Confidence'
            };
            confidenceText.textContent = confidenceLabels[results.confidence];
            
            // Update detailed stage description
            displayStageDescription(results.stage, results.stageDescription);
            
            // Update characteristics
            displayCharacteristics(results.characteristics);
            
            // Show results
            document.getElementById('results').classList.add('show');
        }

        function displayStageDescription(stageName, stageDescription) {
            const card = document.getElementById('stageDescriptionCard');
            const title = document.getElementById('stageDescriptionTitle');
            const text = document.getElementById('stageDescriptionText');
            
            title.textContent = 'Understanding Your ' + stageName + ' Nature';
            text.textContent = stageDescription;
            
            // Add stage-specific styling
            card.className = 'stage-description-card';
            if (stageName.includes('Infant')) card.classList.add('infant');
            else if (stageName.includes('Baby')) card.classList.add('baby');
            else if (stageName.includes('Young')) card.classList.add('young');
            else if (stageName.includes('Mature')) card.classList.add('mature');
            else if (stageName.includes('Old')) card.classList.add('old');
        }

        function displayCharacteristics(characteristics) {
            const container = document.getElementById('characteristicsDisplay');
            
            container.innerHTML = '<div class="characteristics-grid">' +
                '<div class="characteristic-card">' +
                    '<h3 class="characteristic-title">Your Strengths</h3>' +
                    '<ul class="characteristic-list">' +
                        characteristics.strengths.map(item => '<li>' + item + '</li>').join('') +
                    '</ul>' +
                '</div>' +
                '<div class="characteristic-card">' +
                    '<h3 class="characteristic-title">Growth Challenges</h3>' +
                    '<ul class="characteristic-list">' +
                        characteristics.challenges.map(item => '<li>' + item + '</li>').join('') +
                    '</ul>' +
                '</div>' +
                '<div class="characteristic-card">' +
                    '<h3 class="characteristic-title">Life Focus Areas</h3>' +
                    '<ul class="characteristic-list">' +
                        characteristics.focus.map(item => '<li>' + item + '</li>').join('') +
                    '</ul>' +
                '</div>' +
                '<div class="characteristic-card">' +
                    '<h3 class="characteristic-title">Recommended Practices</h3>' +
                    '<ul class="characteristic-list">' +
                        characteristics.practices.map(item => '<li>' + item + '</li>').join('') +
                    '</ul>' +
                '</div>' +
            '</div>';
        }

        function getOrdinalSuffix(number) {
            const suffixes = ['th', 'st', 'nd', 'rd'];
            const value = number % 100;
            return suffixes[(value - 20) % 10] || suffixes[value] || suffixes[0];
        }

        // Jaimini Chart Calculation
        async function calculateJaiminiChart() {
            const button = event.target;
            button.disabled = true;
            button.textContent = '🔮 Calculating Jaimini Chart...';
            
            // Check if birth info is filled
            const dateValid = validateDate();
            const locationValid = validateLocation();
            
            if (!dateValid || !locationValid) {
                alert('Please fill in your birth date and location first.');
                button.disabled = false;
                button.textContent = '🔮 Calculate Jaimini Chart 🔮';
                return;
            }
            
            // Simulate calculation time
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            try {
                const jaiminiResults = performJaiminiCalculation();
                displayJaiminiResults(jaiminiResults);
                
                // Scroll to results
                document.getElementById('jaimini-results').scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
                
            } catch (error) {
                console.error('Jaimini calculation error:', error);
                alert('Sorry, there was an error calculating your Jaimini chart. Please try again.');
            } finally {
                button.disabled = false;
                button.textContent = '🔮 Calculate Jaimini Chart 🔮';
            }
        }

        function performJaiminiCalculation() {
            const birthDate = new Date(document.getElementById('birthDate').value);
            const birthHour = document.getElementById('birthHour').value || '12';
            const birthMinute = document.getElementById('birthMinute').value || '0';
            const ampm = document.getElementById('ampm').value || 'PM';
            
            // Convert to 24-hour time
            let hour24 = parseInt(birthHour);
            if (ampm === 'PM' && hour24 !== 12) hour24 += 12;
            if (ampm === 'AM' && hour24 === 12) hour24 = 0;
            
            const birthTime = new Date(birthDate.getFullYear(), birthDate.getMonth(), birthDate.getDate(), hour24, parseInt(birthMinute));
            const astroFactors = calculateAstrologicalFactors(birthTime, currentLocationData);
            
            // Jaimini-specific calculations
            const planets = ['Sun', 'Moon', 'Mars', 'Mercury', 'Jupiter', 'Venus', 'Saturn', 'Rahu', 'Ketu'];
            const houses = ['1st', '2nd', '3rd', '4th', '5th', '6th', '7th', '8th', '9th', '10th', '11th', '12th'];
            const karmicThemes = ['Dharma', 'Artha', 'Kama', 'Moksha'];
            const soulLessons = ['Power', 'Love', 'Wisdom', 'Service', 'Expression', 'Harmony', 'Truth'];
            
            const atmakaraka = planets[astroFactors.atmakaraka % planets.length];
            const arudhaLagna = houses[astroFactors.arudhaLagna];
            const karmicTheme = karmicThemes[astroFactors.dayOfYear % 4];
            const soulLesson = soulLessons[(astroFactors.atmakaraka + astroFactors.arudhaLagna) % soulLessons.length];
            
            return {
                atmakaraka,
                arudhaLagna,
                karmicTheme,
                soulLesson,
                analysis: generateJaiminiAnalysis(atmakaraka, karmicTheme, soulLesson)
            };
        }

        function generateJaiminiAnalysis(atmakaraka, karmicTheme, soulLesson) {
            const analyses = {
                'Sun': {
                    title: 'Solar Atmakaraka - The Leader\'s Path',
                    description: 'Your soul seeks to learn leadership, self-expression, and personal authority. You came to develop confidence and the ability to shine your unique light.',
                    traits: ['Natural leadership abilities', 'Strong sense of identity', 'Creative self-expression', 'Desire for recognition']
                },
                'Moon': {
                    title: 'Lunar Atmakaraka - The Nurturer\'s Journey',
                    description: 'Your soul is learning about emotions, nurturing, and intuitive wisdom. You came to develop emotional intelligence and caring for others.',
                    traits: ['Deep emotional sensitivity', 'Natural nurturing instincts', 'Strong intuition', 'Connection to the feminine principle']
                },
                'Mars': {
                    title: 'Martian Atmakaraka - The Warrior\'s Quest',
                    description: 'Your soul seeks to master courage, action, and personal will. You came to learn how to fight for what\'s right and overcome obstacles.',
                    traits: ['Natural courage and bravery', 'Strong competitive spirit', 'Ability to take decisive action', 'Warrior mentality']
                },
                'Mercury': {
                    title: 'Mercurial Atmakaraka - The Messenger\'s Mission',
                    description: 'Your soul is learning communication, intelligence, and the power of the mind. You came to master information and connect ideas.',
                    traits: ['Quick mental abilities', 'Natural communication skills', 'Love of learning', 'Adaptability and versatility']
                },
                'Jupiter': {
                    title: 'Jupiterian Atmakaraka - The Teacher\'s Path',
                    description: 'Your soul seeks wisdom, teaching, and spiritual growth. You came to expand consciousness and guide others to higher understanding.',
                    traits: ['Natural wisdom and knowledge', 'Teaching and mentoring abilities', 'Spiritual inclinations', 'Optimistic worldview']
                },
                'Venus': {
                    title: 'Venusian Atmakaraka - The Artist\'s Journey',
                    description: 'Your soul is learning about love, beauty, and harmony. You came to master relationships and create beauty in the world.',
                    traits: ['Appreciation for beauty', 'Natural artistic abilities', 'Strong relationship focus', 'Desire for harmony']
                },
                'Saturn': {
                    title: 'Saturnian Atmakaraka - The Master\'s Challenge',
                    description: 'Your soul seeks to learn discipline, responsibility, and mastery through challenges. You came to build lasting structures and wisdom.',
                    traits: ['Strong sense of responsibility', 'Natural discipline', 'Ability to work through challenges', 'Focus on long-term goals']
                }
            };
            
            return analyses[atmakaraka] || analyses['Sun'];
        }

        function displayJaiminiResults(results) {
            // Update main display
            document.getElementById('atmakaraka').textContent = results.atmakaraka;
            document.getElementById('arudhaLagna').textContent = results.arudhaLagna;
            document.getElementById('karmicTheme').textContent = results.karmicTheme;
            document.getElementById('soulLesson').textContent = results.soulLesson;
            
            document.getElementById('jaiminiDescription').textContent = results.analysis.description;
            
            // Create analysis cards
            const cardsContainer = document.getElementById('jaiminiCards');
            cardsContainer.innerHTML = 
                '<div class="characteristic-card" style="margin-bottom: 20px;">' +
                    '<h3 class="characteristic-title">' + results.analysis.title + '</h3>' +
                    '<p style="color: #6B7280; line-height: 1.6; margin-bottom: 15px;">' + results.analysis.description + '</p>' +
                    '<ul class="characteristic-list">' +
                        results.analysis.traits.map(trait => '<li>' + trait + '</li>').join('') +
                    '</ul>' +
                '</div>' +
                '<div class="characteristic-card">' +
                    '<h3 class="characteristic-title">Your Karmic Theme: ' + results.karmicTheme + '</h3>' +
                    '<p style="color: #6B7280; line-height: 1.6;">' +
                        getKarmicThemeDescription(results.karmicTheme) +
                    '</p>' +
                '</div>';
            
            // Generate and display spiritual guidance
            generateSpiritualGuidance(results);
            
            // Show results
            document.getElementById('jaimini-results').classList.add('show');
        }

        function generateSpiritualGuidance(results) {
            // General Spiritual Guidance
            const generalGuidance = getGeneralSpiritualGuidance(results.atmakaraka, results.soulLesson);
            document.getElementById('generalGuidanceContent').innerHTML = generalGuidance;
            
            // Vedantic Guidance
            const vedicGuidance = getVedicGuidance(results.atmakaraka, results.karmicTheme);
            document.getElementById('vedicGuidanceContent').innerHTML = vedicGuidance;
            
            // Daily Practices
            const dailyPractices = getDailyPractices(results.atmakaraka, results.soulLesson);
            document.getElementById('dailyPracticesContent').innerHTML = dailyPractices;
            
            // Karmic Guidance
            const karmicGuidance = getKarmicGuidance(results.karmicTheme, results.soulLesson);
            document.getElementById('karmicGuidanceContent').innerHTML = karmicGuidance;
            
            // Meditation Guidance
            const meditationGuidance = getMeditationGuidance(results.atmakaraka);
            document.getElementById('meditationGuidanceContent').innerHTML = meditationGuidance;
            
            // Life Guidance
            const lifeGuidance = getLifeGuidance(results.atmakaraka, results.karmicTheme);
            document.getElementById('lifeGuidanceContent').innerHTML = lifeGuidance;
        }

        function getGeneralSpiritualGuidance(atmakaraka, soulLesson) {
            const guidance = {
                'Sun': {
                    practices: ['Practice self-confidence affirmations daily', 'Express your unique talents creatively', 'Take leadership roles in community service', 'Spend time in sunlight for energy'],
                    focus: 'Your soul is learning to shine its authentic light without ego attachment.',
                    affirmation: '"I express my unique gifts with confidence and humility."'
                },
                'Moon': {
                    practices: ['Practice emotional awareness meditation', 'Keep a feelings journal', 'Engage in nurturing activities', 'Connect with water elements (baths, ocean, lakes)'],
                    focus: 'Your soul is developing emotional intelligence and intuitive wisdom.',
                    affirmation: '"I trust my intuition and honor my emotional wisdom."'
                },
                'Mars': {
                    practices: ['Channel anger through physical exercise', 'Practice assertiveness without aggression', 'Take on challenges that require courage', 'Learn martial arts or competitive sports'],
                    focus: 'Your soul is mastering the warrior energy of righteous action.',
                    affirmation: '"I act with courage and stand up for what is right."'
                },
                'Mercury': {
                    practices: ['Practice active listening', 'Write or journal regularly', 'Learn new communication skills', 'Study different subjects to expand knowledge'],
                    focus: 'Your soul is developing the power of conscious communication.',
                    affirmation: '"I communicate with clarity, wisdom, and compassion."'
                },
                'Jupiter': {
                    practices: ['Study spiritual or philosophical texts', 'Mentor others in your areas of expertise', 'Travel to expand your worldview', 'Practice gratitude daily'],
                    focus: 'Your soul is expanding into wisdom and higher knowledge.',
                    affirmation: '"I am a student and teacher of life\'s greater truths."'
                },
                'Venus': {
                    practices: ['Create or appreciate beauty daily', 'Practice loving-kindness meditation', 'Cultivate harmonious relationships', 'Express yourself through art or music'],
                    focus: 'Your soul is learning the art of love and harmony.',
                    affirmation: '"I create and recognize beauty in all aspects of life."'
                },
                'Saturn': {
                    practices: ['Develop consistent daily routines', 'Practice patience with long-term goals', 'Take responsibility for your actions', 'Learn from challenges and setbacks'],
                    focus: 'Your soul is mastering discipline and spiritual responsibility.',
                    affirmation: '"I embrace life\'s lessons with patience and wisdom."'
                }
            };
            
            const planetGuidance = guidance[atmakaraka] || guidance['Sun'];
            
            return '<p style="color: #4B5563; line-height: 1.7; margin-bottom: 20px;">' +
                '<strong>Your Soul\'s Focus:</strong> ' + planetGuidance.focus +
                '</p>' +
                '<div style="background: #F0F9FF; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid var(--secondary);">' +
                    '<h4 style="color: var(--secondary); font-weight: 700; margin-bottom: 10px;">Daily Affirmation</h4>' +
                    '<p style="font-style: italic; color: #374151; font-size: 1.1rem;">' + planetGuidance.affirmation + '</p>' +
                '</div>' +
                '<h4 style="color: var(--primary); font-weight: 700; margin-bottom: 15px;">Recommended Spiritual Practices:</h4>' +
                '<ul style="color: #6B7280; line-height: 1.6; padding-left: 20px;">' +
                    planetGuidance.practices.map(practice => '<li style="margin-bottom: 8px;">' + practice + '</li>').join('') +
                '</ul>';
        }

        function getVedicGuidance(atmakaraka, karmicTheme) {
            const vedicGuidance = {
                'Sun': {
                    mantra: 'Om Suryaya Namaha',
                    deity: 'Surya (Sun God)',
                    practice: 'Surya Namaskara (Sun Salutations)',
                    gemstone: 'Ruby or Red Coral',
                    yantra: 'Surya Yantra',
                    description: 'Honor the divine light within you through solar practices.'
                },
                'Moon': {
                    mantra: 'Om Chandraya Namaha',
                    deity: 'Chandra (Moon God)',
                    practice: 'Chandra Namaskara (Moon Salutations)',
                    gemstone: 'Pearl or Moonstone',
                    yantra: 'Chandra Yantra',
                    description: 'Connect with the divine feminine and intuitive wisdom.'
                },
                'Mars': {
                    mantra: 'Om Angarakaya Namaha',
                    deity: 'Hanuman or Kartikeya',
                    practice: 'Hanuman Chalisa or martial practices',
                    gemstone: 'Red Coral',
                    yantra: 'Mangal Yantra',
                    description: 'Channel divine warrior energy for righteous action.'
                },
                'Mercury': {
                    mantra: 'Om Budhaya Namaha',
                    deity: 'Saraswati or Ganesha',
                    practice: 'Study of sacred texts and mantras',
                    gemstone: 'Emerald',
                    yantra: 'Budh Yantra',
                    description: 'Invoke divine wisdom and communication skills.'
                },
                'Jupiter': {
                    mantra: 'Om Gurave Namaha',
                    deity: 'Dakshinamurti or Brihaspati',
                    practice: 'Guru meditation and seva (service)',
                    gemstone: 'Yellow Sapphire',
                    yantra: 'Guru Yantra',
                    description: 'Connect with the divine teacher within and without.'
                },
                'Venus': {
                    mantra: 'Om Shukraya Namaha',
                    deity: 'Lakshmi or Parvati',
                    practice: 'Bhakti yoga and artistic creation',
                    gemstone: 'Diamond or White Sapphire',
                    yantra: 'Shukra Yantra',
                    description: 'Cultivate divine love and aesthetic appreciation.'
                },
                'Saturn': {
                    mantra: 'Om Shanicharaya Namaha',
                    deity: 'Shani Dev',
                    practice: 'Karma yoga and disciplined sadhana',
                    gemstone: 'Blue Sapphire (use with caution)',
                    yantra: 'Shani Yantra',
                    description: 'Transform through disciplined spiritual practice.'
                }
            };
            
            const guidance = vedicGuidance[atmakaraka] || vedicGuidance['Sun'];
            
            return '<div style="display: grid; gap: 15px;">' +
                '<div style="background: #FEF7E7; padding: 15px; border-radius: 10px; border-left: 4px solid var(--sacred-gold);">' +
                    '<h4 style="color: var(--sacred-gold); font-weight: 700; margin-bottom: 8px;">Your Planetary Mantra</h4>' +
                    '<p style="font-size: 1.2rem; font-weight: 600; color: #92400E; margin-bottom: 8px;">' + guidance.mantra + '</p>' +
                    '<p style="color: #6B7280; font-size: 0.95rem;">Chant 108 times daily, especially during sunrise or your planetary hour.</p>' +
                '</div>' +
                '<div style="background: #F0FDF4; padding: 15px; border-radius: 10px; border-left: 4px solid var(--success);">' +
                    '<h4 style="color: var(--success); font-weight: 700; margin-bottom: 8px;">Associated Deity</h4>' +
                    '<p style="color: #374151; margin-bottom: 8px;"><strong>' + guidance.deity + '</strong></p>' +
                    '<p style="color: #6B7280; font-size: 0.95rem;">' + guidance.description + '</p>' +
                '</div>' +
                '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">' +
                    '<div style="background: #FDF4FF; padding: 15px; border-radius: 10px;">' +
                        '<h4 style="color: var(--primary); font-weight: 700; margin-bottom: 8px;">Recommended Practice</h4>' +
                        '<p style="color: #6B7280;">' + guidance.practice + '</p>' +
                    '</div>' +
                    '<div style="background: #ECFEFF; padding: 15px; border-radius: 10px;">' +
                        '<h4 style="color: var(--secondary); font-weight: 700; margin-bottom: 8px;">Supportive Gemstone</h4>' +
                        '<p style="color: #6B7280;">' + guidance.gemstone + '</p>' +
                        '<p style="color: #6B7280; font-size: 0.85rem; margin-top: 5px;">(Consult an expert before wearing)</p>' +
                    '</div>' +
                '</div>' +
            '</div>';
        }

        function getDailyPractices(atmakaraka, soulLesson) {
            const practices = {
                'Sun': {
                    morning: 'Face east and greet the sunrise with gratitude',
                    midday: 'Take a leadership role in one small situation',
                    evening: 'Reflect on how you expressed your authentic self',
                    weekly: 'Spend time in nature on Sundays, do creative projects'
                },
                'Moon': {
                    morning: 'Check in with your emotions and intuition',
                    midday: 'Practice nurturing yourself or others',
                    evening: 'Moon gazing or water-based relaxation',
                    weekly: 'Track moon phases, practice emotional healing on Mondays'
                },
                'Mars': {
                    morning: 'Physical exercise or energizing movement',
                    midday: 'Take decisive action on one important task',
                    evening: 'Channel any remaining energy constructively',
                    weekly: 'Competitive activities or courage-building challenges on Tuesdays'
                },
                'Mercury': {
                    morning: 'Read something educational or inspiring',
                    midday: 'Practice mindful communication in conversations',
                    evening: 'Write in a journal or learn something new',
                    weekly: 'Study or teach others on Wednesdays'
                },
                'Jupiter': {
                    morning: 'Study spiritual or philosophical material',
                    midday: 'Share knowledge or mentor someone',
                    evening: 'Express gratitude for the day\'s learning',
                    weekly: 'Attend spiritual gatherings or expand worldview on Thursdays'
                },
                'Venus': {
                    morning: 'Appreciate something beautiful in your environment',
                    midday: 'Express love or create harmony in relationships',
                    evening: 'Engage in artistic or aesthetic activities',
                    weekly: 'Create beauty or enjoy arts on Fridays'
                },
                'Saturn': {
                    morning: 'Plan your day with disciplined intention',
                    midday: 'Take responsibility for challenges',
                    evening: 'Review lessons learned and progress made',
                    weekly: 'Focus on long-term goals and spiritual discipline on Saturdays'
                }
            };
            
            const planetPractices = practices[atmakaraka] || practices['Sun'];
            
            return '<div style="display: grid; gap: 20px;">' +
                '<div style="background: linear-gradient(135deg, #FEF7E7 0%, #FFFBEB 100%); padding: 20px; border-radius: 12px;">' +
                    '<h4 style="color: var(--sacred-gold); font-weight: 700; margin-bottom: 15px; font-size: 1.1rem;">Daily Rhythm for Your Soul</h4>' +
                    '<div style="display: grid; gap: 12px;">' +
                        '<div style="display: flex; align-items: center; gap: 10px;">' +
                            '<span style="background: #F59E0B; color: white; padding: 4px 8px; border-radius: 6px; font-size: 0.8rem; font-weight: 600;">MORNING</span>' +
                            '<span style="color: #374151;">' + planetPractices.morning + '</span>' +
                        '</div>' +
                        '<div style="display: flex; align-items: center; gap: 10px;">' +
                            '<span style="background: #EF4444; color: white; padding: 4px 8px; border-radius: 6px; font-size: 0.8rem; font-weight: 600;">MIDDAY</span>' +
                            '<span style="color: #374151;">' + planetPractices.midday + '</span>' +
                        '</div>' +
                        '<div style="display: flex; align-items: center; gap: 10px;">' +
                            '<span style="background: #8B5CF6; color: white; padding: 4px 8px; border-radius: 6px; font-size: 0.8rem; font-weight: 600;">EVENING</span>' +
                            '<span style="color: #374151;">' + planetPractices.evening + '</span>' +
                        '</div>' +
                    '</div>' +
                '</div>' +
                '<div style="background: #F0F9FF; padding: 20px; border-radius: 12px; border-left: 4px solid var(--secondary);">' +
                    '<h4 style="color: var(--secondary); font-weight: 700; margin-bottom: 10px;">Weekly Focus</h4>' +
                    '<p style="color: #374151; line-height: 1.6;">' + planetPractices.weekly + '</p>' +
                '</div>' +
                '<div style="background: #F9FAFB; padding: 20px; border-radius: 12px;">' +
                    '<h4 style="color: var(--primary); font-weight: 700; margin-bottom: 15px;">Progress Tracking</h4>' +
                    '<ul style="color: #6B7280; line-height: 1.6; padding-left: 20px;">' +
                        '<li>Keep a spiritual practice journal</li>' +
                        '<li>Notice patterns in your energy and mood</li>' +
                        '<li>Celebrate small victories in your soul lesson: <strong>' + soulLesson + '</strong></li>' +
                        '<li>Adjust practices based on what resonates most</li>' +
                    '</ul>' +
                '</div>' +
            '</div>';
        }

        function getKarmicGuidance(karmicTheme, soulLesson) {
            const karmicWisdom = {
                'Dharma': {
                    purpose: 'Your soul is here to learn righteous living and spiritual duty',
                    lessons: ['Understanding your life purpose', 'Balancing personal needs with service', 'Developing moral clarity', 'Aligning actions with higher principles'],
                    challenges: ['Rigidity in moral judgments', 'Sacrificing personal needs', 'Judgmental attitudes', 'Perfectionism'],
                    growth: 'Practice compassionate discernment and flexible righteousness'
                },
                'Artha': {
                    purpose: 'Your soul is mastering material success and security',
                    lessons: ['Healthy relationship with money and resources', 'Building sustainable foundations', 'Balancing material and spiritual needs', 'Using resources for higher purpose'],
                    challenges: ['Materialism', 'Fear of scarcity', 'Overwork', 'Neglecting spiritual growth'],
                    growth: 'See material success as a tool for spiritual service'
                },
                'Kama': {
                    purpose: 'Your soul is exploring desire, creativity, and emotional fulfillment',
                    lessons: ['Understanding healthy vs. unhealthy desires', 'Creative self-expression', 'Emotional intelligence', 'Relationship dynamics'],
                    challenges: ['Addiction to pleasure', 'Emotional extremes', 'Relationship drama', 'Creative blocks'],
                    growth: 'Transform desires into fuel for spiritual creativity'
                },
                'Moksha': {
                    purpose: 'Your soul is seeking liberation and spiritual realization',
                    lessons: ['Detachment without withdrawal', 'Finding God/Truth in everyday life', 'Transcending ego identification', 'Serving others\' spiritual growth'],
                    challenges: ['Spiritual bypassing', 'Isolation from world', 'Superiority complex', 'Neglecting practical responsibilities'],
                    growth: 'Integrate spiritual wisdom into practical, loving service'
                }
            };
            
            const guidance = karmicWisdom[karmicTheme] || karmicWisdom['Dharma'];
            
            return '<div style="display: grid; gap: 20px;">' +
                '<div style="background: linear-gradient(135deg, #EDE9FE 0%, #F3F4F6 100%); padding: 20px; border-radius: 12px;">' +
                    '<h4 style="color: var(--primary); font-weight: 700; margin-bottom: 12px;">Your Soul\'s Primary Mission</h4>' +
                    '<p style="color: #374151; line-height: 1.7; font-size: 1.05rem;">' + guidance.purpose + '</p>' +
                '</div>' +
                '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">' +
                    '<div style="background: #F0FDF4; padding: 18px; border-radius: 12px;">' +
                        '<h4 style="color: var(--success); font-weight: 700; margin-bottom: 12px;">Key Lessons to Master</h4>' +
                        '<ul style="color: #374151; line-height: 1.6; padding-left: 18px;">' +
                            guidance.lessons.map(lesson => '<li style="margin-bottom: 6px;">' + lesson + '</li>').join('') +
                        '</ul>' +
                    '</div>' +
                    '<div style="background: #FEF3C7; padding: 18px; border-radius: 12px;">' +
                        '<h4 style="color: #D97706; font-weight: 700; margin-bottom: 12px;">Common Soul Challenges</h4>' +
                        '<ul style="color: #374151; line-height: 1.6; padding-left: 18px;">' +
                            guidance.challenges.map(challenge => '<li style="margin-bottom: 6px;">' + challenge + '</li>').join('') +
                        '</ul>' +
                    '</div>' +
                '</div>' +
                '<div style="background: #DBEAFE; padding: 20px; border-radius: 12px; border-left: 4px solid var(--secondary);">' +
                    '<h4 style="color: var(--secondary); font-weight: 700; margin-bottom: 12px;">Path to Spiritual Growth</h4>' +
                    '<p style="color: #374151; line-height: 1.7;">' + guidance.growth + '</p>' +
                    '<div style="margin-top: 15px; padding: 12px; background: rgba(255, 255, 255, 0.7); border-radius: 8px;">' +
                        '<strong style="color: var(--secondary);">Focus on your Soul Lesson:</strong> ' +
                        '<span style="color: #374151;">' + soulLesson + ' - This is your key to accelerated spiritual development.</span>' +
                    '</div>' +
                '</div>' +
            '</div>';
        }

        function getMeditationGuidance(atmakaraka) {
            const meditations = {
                'Sun': {
                    primary: 'Solar Visualization Meditation',
                    technique: 'Visualize golden light entering through your crown chakra, filling your entire being with confidence and clarity.',
                    duration: '15-20 minutes at sunrise or noon',
                    breathwork: 'Surya Pranayama - 4 counts in, hold for 4, out for 4',
                    mantra: 'So Hum (I Am) or Om Suryaya Namaha',
                    benefits: 'Builds self-confidence, leadership qualities, and authentic self-expression'
                },
                'Moon': {
                    primary: 'Lunar Intuition Meditation',
                    technique: 'Sit quietly and focus on your emotional body. Notice feelings without judgment, letting them flow like tides.',
                    duration: '15-30 minutes in the evening or during full moon',
                    breathwork: 'Chandra Pranayama - natural, gentle breathing like waves',
                    mantra: 'Om Chandraya Namaha or simply Ahhh sound',
                    benefits: 'Develops intuition, emotional intelligence, and inner receptivity'
                },
                'Mars': {
                    primary: 'Warrior Courage Meditation',
                    technique: 'Visualize yourself as a spiritual warrior, channeling righteous energy to overcome obstacles.',
                    duration: '10-15 minutes, especially when facing challenges',
                    breathwork: 'Bhastrika (Bellows Breath) - powerful, rhythmic breathing',
                    mantra: 'Om Gam Ganapataye Namaha or Om Hanumate Namaha',
                    benefits: 'Builds courage, determination, and ability to take right action'
                },
                'Mercury': {
                    primary: 'Mindfulness Communication Meditation',
                    technique: 'Focus on the quality of your thoughts and words. Practice speaking internally with clarity and compassion.',
                    duration: '10-20 minutes before important communications',
                    breathwork: 'Alternate nostril breathing for mental balance',
                    mantra: 'Om Budhaya Namaha or Gam (Ganesha bija)',
                    benefits: 'Enhances communication skills, mental clarity, and learning ability'
                },
                'Jupiter': {
                    primary: 'Wisdom Expansion Meditation',
                    technique: 'Contemplate a spiritual question or text. Allow insights to arise naturally without forcing.',
                    duration: '20-30 minutes, preferably on Thursdays',
                    breathwork: 'Deep, slow breathing to expand consciousness',
                    mantra: 'Om Gurave Namaha or Om Gam Ganapataye Namaha',
                    benefits: 'Develops wisdom, spiritual understanding, and teaching abilities'
                },
                'Venus': {
                    primary: 'Heart-Centered Love Meditation',
                    technique: 'Focus on your heart chakra, radiating love to yourself, loved ones, and all beings.',
                    duration: '15-25 minutes, especially on Fridays',
                    breathwork: 'Heart-centered breathing, imagining breath flowing through your heart',
                    mantra: 'Om Shrim Lakshmi Namaha or simply Aum',
                    benefits: 'Cultivates unconditional love, harmony, and aesthetic appreciation'
                },
                'Saturn': {
                    primary: 'Disciplined Awareness Meditation',
                    technique: 'Sit in perfect stillness, observing the mind without attachment. Build spiritual discipline through consistent practice.',
                    duration: '20-45 minutes daily, same time each day',
                    breathwork: 'Slow, measured breathing with long retention',
                    mantra: 'Om Shani Devaya Namaha or So Hum',
                    benefits: 'Builds spiritual discipline, patience, and deep inner stability'
                }
            };
            
            const meditation = meditations[atmakaraka] || meditations['Sun'];
            
            return '<div style="display: grid; gap: 20px;">' +
                '<div style="background: linear-gradient(135deg, #F3E8FF 0%, #FAF5FF 100%); padding: 20px; border-radius: 12px;">' +
                    '<h4 style="color: var(--primary); font-weight: 700; margin-bottom: 15px; font-size: 1.2rem;">' + meditation.primary + '</h4>' +
                    '<p style="color: #374151; line-height: 1.7; margin-bottom: 15px;">' + meditation.technique + '</p>' +
                    '<div style="display: grid; grid-template-columns: auto 1fr; gap: 8px; align-items: center;">' +
                        '<span style="background: var(--primary); color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem;">DURATION</span>' +
                        '<span style="color: #4B5563;">' + meditation.duration + '</span>' +
                    '</div>' +
                '</div>' +
                '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">' +
                    '<div style="background: #FFF7ED; padding: 18px; border-radius: 12px;">' +
                        '<h4 style="color: #EA580C; font-weight: 700; margin-bottom: 12px;">Breathwork Technique</h4>' +
                        '<p style="color: #374151; line-height: 1.6;">' + meditation.breathwork + '</p>' +
                    '</div>' +
                    '<div style="background: #ECFDF5; padding: 18px; border-radius: 12px;">' +
                        '<h4 style="color: var(--success); font-weight: 700; margin-bottom: 12px;">Sacred Mantra</h4>' +
                        '<p style="color: #374151; line-height: 1.6; font-style: italic;">' + meditation.mantra + '</p>' +
                    '</div>' +
                '</div>' +
                '<div style="background: #F0F9FF; padding: 20px; border-radius: 12px; border-left: 4px solid var(--secondary);">' +
                    '<h4 style="color: var(--secondary); font-weight: 700; margin-bottom: 12px;">Benefits for Your Soul Path</h4>' +
                    '<p style="color: #374151; line-height: 1.7;">' + meditation.benefits + '</p>' +
                '</div>' +
                '<div style="background: #FAFAFA; padding: 20px; border-radius: 12px; border: 2px dashed #D1D5DB;">' +
                    '<h4 style="color: #374151; font-weight: 700; margin-bottom: 15px;">Getting Started Tips</h4>' +
                    '<ul style="color: #6B7280; line-height: 1.6; padding-left: 20px;">' +
                        '<li>Start with just 5 minutes and gradually increase</li>' +
                        '<li>Create a dedicated, quiet space for practice</li>' +
                        '<li>Practice at the same time daily for best results</li>' +
                        '<li>Don\'t judge your meditations - consistency matters more than perfection</li>' +
                        '<li>Notice how your meditation affects your daily life and relationships</li>' +
                    '</ul>' +
                '</div>' +
            '</div>';
        }

        function getLifeGuidance(atmakaraka, karmicTheme) {
            const lifeGuidance = {
                'Sun': {
                    relationships: 'You attract people who need your leadership and inspiration. Practice shining your light without overshadowing others.',
                    career: 'Seek roles where you can lead, create, or inspire others. Avoid ego-driven positions that don\'t serve a higher purpose.',
                    challenges: 'Balance self-expression with humility. Your soul lesson is to lead with love, not just authority.',
                    soulMate: 'Look for someone who appreciates your uniqueness but isn\'t intimidated by your strength.'
                },
                'Moon': {
                    relationships: 'You\'re here to learn nurturing and emotional intelligence. Your relationships are your greatest teachers.',
                    career: 'Consider helping professions, hospitality, or anything involving care and intuition. Your emotional wisdom is your gift.',
                    challenges: 'Avoid emotional extremes and co-dependency. Learn to nurture without losing yourself.',
                    soulMate: 'Seek someone who values emotional depth and can provide the security your soul needs.'
                },
                'Mars': {
                    relationships: 'You\'re learning to balance assertion with cooperation. Your passion can heal or harm - choose wisely.',
                    career: 'Excellent in competitive fields, sports, military, or anywhere courage is needed. Fight for causes that matter.',
                    challenges: 'Channel anger constructively. Your soul is mastering righteous action, not just reactive force.',
                    soulMate: 'You need someone who can match your intensity but also help you find peace.'
                },
                'Mercury': {
                    relationships: 'Communication is your relationship superpower and challenge. Practice listening as much as speaking.',
                    career: 'Teaching, writing, technology, sales, or any field requiring mental agility suits your soul path.',
                    challenges: 'Avoid superficiality and mental restlessness. Depth of connection matters more than variety.',
                    soulMate: 'Look for intellectual compatibility and someone who enjoys meaningful conversation.'
                },
                'Jupiter': {
                    relationships: 'You\'re here to be a teacher and student in relationships. Share wisdom but remain humble.',
                    career: 'Education, law, spirituality, counseling, or international work aligns with your soul\'s expansion.',
                    challenges: 'Avoid preaching or spiritual superiority. True wisdom includes compassion for all levels.',
                    soulMate: 'Seek someone who shares your philosophical outlook and supports your spiritual growth.'
                },
                'Venus': {
                    relationships: 'Love is your primary curriculum. You\'re learning to create harmony without losing authenticity.',
                    career: 'Arts, beauty industry, counseling, diplomacy, or anything involving aesthetics and relationships.',
                    challenges: 'Balance pleasing others with being true to yourself. Learn to handle conflict gracefully.',
                    soulMate: 'You attract partnerships that teach you about love\'s many expressions - both challenging and beautiful.'
                },
                'Saturn': {
                    relationships: 'You\'re learning commitment, responsibility, and patience in relationships. Quality over quantity.',
                    career: 'Management, engineering, construction, law, or any field requiring discipline and long-term vision.',
                    challenges: 'Avoid being overly critical or rigid. Your soul is learning compassionate authority.',
                    soulMate: 'You need someone reliable who appreciates your stability and helps you enjoy life\'s lighter moments.'
                }
            };
            
            const guidance = lifeGuidance[atmakaraka] || lifeGuidance['Sun'];
            
            return '<div style="display: grid; gap: 20px;">' +
                '<div style="background: linear-gradient(135deg, #FDF2F8 0%, #FCE7F3 100%); padding: 20px; border-radius: 12px;">' +
                    '<h4 style="color: #BE185D; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">' +
                        'Relationships & Soul Growth' +
                    '</h4>' +
                    '<p style="color: #374151; line-height: 1.7;">' + guidance.relationships + '</p>' +
                    '<div style="margin-top: 12px; padding: 12px; background: rgba(255, 255, 255, 0.7); border-radius: 8px;">' +
                        '<strong style="color: #BE185D;">Soul Mate Guidance:</strong>' +
                        '<span style="color: #374151;"> ' + guidance.soulMate + '</span>' +
                    '</div>' +
                '</div>' +
                '<div style="background: linear-gradient(135deg, #EFF6FF 0%, #DBEAFE 100%); padding: 20px; border-radius: 12px;">' +
                    '<h4 style="color: #1D4ED8; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">' +
                        'Career & Life Purpose' +
                    '</h4>' +
                    '<p style="color: #374151; line-height: 1.7;">' + guidance.career + '</p>' +
                '</div>' +
                '<div style="background: #FEF3C7; padding: 20px; border-radius: 12px; border-left: 4px solid #F59E0B;">' +
                    '<h4 style="color: #D97706; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">' +
                        'Your Soul Challenges' +
                    '</h4>' +
                    '<p style="color: #374151; line-height: 1.7;">' + guidance.challenges + '</p>' +
                '</div>' +
                '<div style="background: #F9FAFB; padding: 20px; border-radius: 12px; border: 2px solid #E5E7EB;">' +
                    '<h4 style="color: #374151; font-weight: 700; margin-bottom: 15px;">Spiritual Integration in Daily Life</h4>' +
                    '<ul style="color: #6B7280; line-height: 1.6; padding-left: 20px;">' +
                        '<li><strong>Before work:</strong> Set an intention to serve through your unique gifts</li>' +
                        '<li><strong>In relationships:</strong> Ask "What is this person teaching my soul?"</li>' +
                        '<li><strong>During challenges:</strong> See them as opportunities for your karmic theme: <strong>' + karmicTheme + '</strong></li>' +
                        '<li><strong>End of day:</strong> Reflect on how you expressed your Atmakaraka energy</li>' +
                    '</ul>' +
                '</div>' +
            '</div>';
        }

        function getKarmicThemeDescription(theme) {
            const descriptions = {
                'Dharma': 'Your soul is focused on learning righteous living, moral duty, and spiritual principles. This lifetime is about aligning with your higher purpose.',
                'Artha': 'Your soul is learning about material success, security, and practical achievement. This lifetime involves mastering the material world.',
                'Kama': 'Your soul is exploring desires, relationships, and emotional fulfillment. This lifetime is about understanding love and passion.',
                'Moksha': 'Your soul is seeking liberation, spiritual realization, and transcendence. This lifetime is about spiritual awakening and freedom.'
            };
            return descriptions[theme] || descriptions['Dharma'];
        }

        // FAQ functionality
        function toggleFaq(questionElement) {
            const answer = questionElement.nextElementSibling;
            const toggle = questionElement.querySelector('.faq-toggle');
            
            if (answer.classList.contains('show')) {
                answer.classList.remove('show');
                toggle.classList.remove('rotated');
            } else {
                // Close all other FAQs
                document.querySelectorAll('.faq-answer.show').forEach(openAnswer => {
                    openAnswer.classList.remove('show');
                    openAnswer.previousElementSibling.querySelector('.faq-toggle').classList.remove('rotated');
                });
                
                // Open this FAQ
                answer.classList.add('show');
                toggle.classList.add('rotated');
            }
        }

        // Click outside to close location dropdown
        document.addEventListener('click', function(event) {
            const locationInput = document.getElementById('birthLocation');
            const dropdown = document.getElementById('locationAutocomplete');
            
            if (!locationInput.contains(event.target) && !dropdown.contains(event.target)) {
                hideLocationDropdown();
            }
        });
    </script>
</body>
</html>
